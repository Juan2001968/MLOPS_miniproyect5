
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>2. Análisis Exploratorio de Datos (EDA) &#8212; Miniproyecto 6 · Telco Churn con Árboles + MLOps</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = '02_eda';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3. Preprocesamiento de Datos" href="03_preprocesamiento.html" />
    <link rel="prev" title="1. Contexto del Dataset: Telco Customer Churn" href="01_contexto_churn.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Miniproyecto 6 · Telco Churn con Árboles + MLOps - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Miniproyecto 6 · Telco Churn con Árboles + MLOps - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Proyecto Integrador: Predicción de Churn en Telecomunicaciones con Modelos de Árboles e Interpretabilidad
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Proyecto</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_contexto_churn.html">1. Contexto del Dataset: <em>Telco Customer Churn</em></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>2. Análisis Exploratorio de Datos (EDA)</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="03_preprocesamiento.html"><strong>3. Preprocesamiento de Datos</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="04_modelado_arboles_gridsearch.html"><strong>4. Modelado</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="05_evaluacion_metricas_clasificacion.html"><strong>5. Evaluacion de metricas</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="06_interpretabilidad.html"><strong>6. Interpretabilidad</strong></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/Juan2001968/MLOPS_miniproyect5" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/Juan2001968/MLOPS_miniproyect5/issues/new?title=Issue%20on%20page%20%2F02_eda.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/02_eda.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>2. Análisis Exploratorio de Datos (EDA)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#librerias">Librerías</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#carga-de-la-base-de-datos"><strong>1. Carga de la Base de Datos</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#descarga-y-carga-del-dataset-telco-customer-churn">Descarga y carga del dataset <em>Telco Customer Churn</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#carga-del-dataframe">Carga del DataFrame</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#vista-previa-de-los-datos">Vista previa de los datos</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lectura-del-dataset-y-verificacion"><strong>2. Lectura del Dataset y verificación</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#salida-observada">Salida observada</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#limpieza-de-nombres-de-columnas"><strong>3. Limpieza de nombres de columnas</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-la-salida-df-info">Interpretación de la salida (<code class="docutils literal notranslate"><span class="pre">df.info()</span></code>)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conversion-de-tipos-target-binario-y-particion-de-variables-numericas-vs-categoricas"><strong>4. Conversión de tipos, target binario y partición de variables (numéricas vs. categóricas)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#que-hace-el-codigo">Qué hace el código</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-la-salida">Interpretación de la salida</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#importancia">Importancia</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conteo-de-valores-faltantes-por-columna"><strong>5. Conteo de valores faltantes por columna</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#distribucion-del-target-churn-porcentaje-y-conteo-implicaciones-de-desbalance"><strong>6. Distribución del target <code class="docutils literal notranslate"><span class="pre">Churn</span></code> (porcentaje y conteo) + implicaciones de desbalance</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Interpretación de la salida</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resumen-estadistico-numericas-cardinalidad-y-top-frecuencias-categoricas"><strong>7. Resumen estadístico (numéricas) + cardinalidad y top-frecuencias (categóricas)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Interpretación de la salida</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#numericas-describe-t">1) Numéricas (<code class="docutils literal notranslate"><span class="pre">describe().T</span></code>)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#categoricas-cardinalidad-y-top-k">2) Categóricas (cardinalidad y top-k)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-univariada-distribuciones-numericas-y-categoricas"><strong>8. Visualización univariada: Distribuciones numéricas y categóricas</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-los-resultados">Interpretación de los resultados</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-numericas">Variables numéricas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-categoricas-barras">Variables categóricas (barras)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusión</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#relacion-de-variables-numericas-con-churn-violines-prueba-de-mannwhitney"><strong>9. Relación de variables numéricas con <code class="docutils literal notranslate"><span class="pre">Churn</span></code>: violines + prueba de Mann–Whitney</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-los-violines">Interpretación de los violines</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resultados-de-mannwhitney">Resultados de Mann–Whitney</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-general">Conclusión general</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prueba-chi-cuadrado-y-barras-apiladas-por-categoria"><strong>10. Prueba Chi-cuadrado y Barras Apiladas por Categoría</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-la-tabla-chi-cuadrado">Interpretación de la tabla Chi-cuadrado</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-las-barras-apiladas-proporciones-por-categoria">Interpretación de las barras apiladas (proporciones por categoría)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Conclusión general</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matriz-de-correlacion-y-variables-numericas-mas-relacionadas-con-el-churn"><strong>11. Matriz de Correlación y Variables Numéricas Más Relacionadas con el Churn</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-la-matriz-de-correlacion">Interpretación de la Matriz de Correlación</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resultados-principales">Resultados principales:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Conclusión</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matriz-de-correlacion-mixta-pearson-cramers-v"><strong>12. Matriz de Correlación Mixta (Pearson + Cramér’s V + η)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-la-matriz-mixta">Interpretación de la matriz mixta</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relaciones-fuertes-entre-variables-categoricas">1. Relaciones fuertes entre variables categóricas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-numericas-asociadas-con-servicios">2. Variables numéricas asociadas con servicios</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bloque-con-el-target-churn">3. Bloque con el target (Churn)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relaciones-debiles">4. Relaciones débiles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Conclusión General</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pairplot-de-las-principales-variables-numericas-vs-churn"><strong>13: Pairplot de las principales variables numéricas vs <code class="docutils literal notranslate"><span class="pre">Churn</span></code></strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pairplot"><strong>Pairplot</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Conclusión</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pca-2d-sobre-variables-numericas-y-relacion-con-churn"><strong>14. PCA 2D sobre variables numéricas y relación con <code class="docutils literal notranslate"><span class="pre">Churn</span></code></strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grafico-de-pca"><strong>Gráfico de PCA</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusiones-del-pca">Conclusiones del PCA</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deteccion-de-outliers-con-iqr-y-z-score"><strong>15.Detección de Outliers con IQR y Z-Score</strong></a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="analisis-exploratorio-de-datos-eda">
<h1><strong>2. Análisis Exploratorio de Datos (EDA)</strong><a class="headerlink" href="#analisis-exploratorio-de-datos-eda" title="Link to this heading">#</a></h1>
<section id="librerias">
<h2>Librerías<a class="headerlink" href="#librerias" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># === Importaciones base del EDA ===</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">chi2_contingency</span><span class="p">,</span> <span class="n">mannwhitneyu</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.max_columns&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
<span class="n">FIGS</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)</span><span class="o">/</span><span class="s2">&quot;docs&quot;</span><span class="o">/</span><span class="s2">&quot;assets&quot;</span><span class="o">/</span><span class="s2">&quot;figuras&quot;</span>
<span class="n">FIGS</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="carga-de-la-base-de-datos">
<h2><strong>1. Carga de la Base de Datos</strong><a class="headerlink" href="#carga-de-la-base-de-datos" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">kagglehub</span>

<span class="c1"># Rutas del proyecto</span>
<span class="n">DATA_DIR</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)</span><span class="o">/</span><span class="s2">&quot;data&quot;</span>
<span class="n">RAW</span> <span class="o">=</span> <span class="n">DATA_DIR</span><span class="o">/</span><span class="s2">&quot;raw&quot;</span>
<span class="n">PROC</span> <span class="o">=</span> <span class="n">DATA_DIR</span><span class="o">/</span><span class="s2">&quot;processed&quot;</span>
<span class="n">RAW</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">PROC</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># 1) Descargar dataset (devuelve la carpeta local del dataset)</span>
<span class="n">local_dir</span> <span class="o">=</span> <span class="n">kagglehub</span><span class="o">.</span><span class="n">dataset_download</span><span class="p">(</span><span class="s2">&quot;blastchar/telco-customer-churn&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Descargado en:&quot;</span><span class="p">,</span> <span class="n">local_dir</span><span class="p">)</span>

<span class="c1"># 2) Nombre del CSV dentro del dataset</span>
<span class="n">csv_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">local_dir</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;WA_Fn-UseC_-Telco-Customer-Churn.csv&quot;</span>

<span class="c1"># 3) Leer CSV</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csv_path</span><span class="p">)</span>

<span class="c1"># 4) Limpieza mínima de columnas y tipos</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">columns</span>
      <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
      <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
      <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
      <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="p">)</span>
<span class="c1"># TotalCharges a numérico (viene con espacios en algunas filas)</span>
<span class="k">if</span> <span class="s2">&quot;TotalCharges&quot;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;TotalCharges&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;TotalCharges&quot;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape:&quot;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># 5) Guardar copias</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">RAW</span><span class="o">/</span><span class="s2">&quot;telco_churn.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="n">PROC</span><span class="o">/</span><span class="s2">&quot;telco_churn.parquet&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Guardado en:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; -&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">RAW</span><span class="o">/</span><span class="s2">&quot;telco_churn.csv&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; -&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">PROC</span><span class="o">/</span><span class="s2">&quot;telco_churn.parquet&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading from https://www.kaggle.com/api/v1/datasets/download/blastchar/telco-customer-churn?dataset_version_number=1...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 172k/172k [00:00&lt;00:00, 1.12MB/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Extracting files...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Descargado en: C:\Users\juana\.cache\kagglehub\datasets\blastchar\telco-customer-churn\versions\1
Shape: (7043, 21)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customerID</th>
      <th>gender</th>
      <th>SeniorCitizen</th>
      <th>Partner</th>
      <th>Dependents</th>
      <th>tenure</th>
      <th>PhoneService</th>
      <th>MultipleLines</th>
      <th>InternetService</th>
      <th>OnlineSecurity</th>
      <th>...</th>
      <th>DeviceProtection</th>
      <th>TechSupport</th>
      <th>StreamingTV</th>
      <th>StreamingMovies</th>
      <th>Contract</th>
      <th>PaperlessBilling</th>
      <th>PaymentMethod</th>
      <th>MonthlyCharges</th>
      <th>TotalCharges</th>
      <th>Churn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7590-VHVEG</td>
      <td>Female</td>
      <td>0</td>
      <td>Yes</td>
      <td>No</td>
      <td>1</td>
      <td>No</td>
      <td>No phone service</td>
      <td>DSL</td>
      <td>No</td>
      <td>...</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>Month-to-month</td>
      <td>Yes</td>
      <td>Electronic check</td>
      <td>29.85</td>
      <td>29.85</td>
      <td>No</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5575-GNVDE</td>
      <td>Male</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
      <td>34</td>
      <td>Yes</td>
      <td>No</td>
      <td>DSL</td>
      <td>Yes</td>
      <td>...</td>
      <td>Yes</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>One year</td>
      <td>No</td>
      <td>Mailed check</td>
      <td>56.95</td>
      <td>1889.50</td>
      <td>No</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3668-QPYBK</td>
      <td>Male</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
      <td>2</td>
      <td>Yes</td>
      <td>No</td>
      <td>DSL</td>
      <td>Yes</td>
      <td>...</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>Month-to-month</td>
      <td>Yes</td>
      <td>Mailed check</td>
      <td>53.85</td>
      <td>108.15</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7795-CFOCW</td>
      <td>Male</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
      <td>45</td>
      <td>No</td>
      <td>No phone service</td>
      <td>DSL</td>
      <td>Yes</td>
      <td>...</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>No</td>
      <td>No</td>
      <td>One year</td>
      <td>No</td>
      <td>Bank transfer (automatic)</td>
      <td>42.30</td>
      <td>1840.75</td>
      <td>No</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9237-HQITU</td>
      <td>Female</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
      <td>2</td>
      <td>Yes</td>
      <td>No</td>
      <td>Fiber optic</td>
      <td>No</td>
      <td>...</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>Month-to-month</td>
      <td>Yes</td>
      <td>Electronic check</td>
      <td>70.70</td>
      <td>151.65</td>
      <td>Yes</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Guardado en:
 - C:\Users\juana\MLOPS\miniproyecto6\data\raw\telco_churn.csv
 - C:\Users\juana\MLOPS\miniproyecto6\data\processed\telco_churn.parquet
</pre></div>
</div>
</div>
</div>
<section id="descarga-y-carga-del-dataset-telco-customer-churn">
<h3>Descarga y carga del dataset <em>Telco Customer Churn</em><a class="headerlink" href="#descarga-y-carga-del-dataset-telco-customer-churn" title="Link to this heading">#</a></h3>
<p>En este bloque se realiza la <strong>descarga automática</strong> del dataset <em>Telco Customer Churn</em> desde <strong>Kaggle</strong> usando la API.</p>
<section id="carga-del-dataframe">
<h4>Carga del DataFrame<a class="headerlink" href="#carga-del-dataframe" title="Link to this heading">#</a></h4>
<p>El dataset se carga correctamente en un <strong>DataFrame de pandas</strong>, con una forma de: (7043, 21)
Esto significa que contiene <strong>7043 observaciones</strong> (clientes) y <strong>21 columnas</strong>, las cuales representan diferentes características del cliente, servicios contratados y la variable objetivo <code class="docutils literal notranslate"><span class="pre">Churn</span></code> (abandono del servicio).</p>
</section>
<section id="vista-previa-de-los-datos">
<h4>Vista previa de los datos<a class="headerlink" href="#vista-previa-de-los-datos" title="Link to this heading">#</a></h4>
<p>Se muestran las primeras 5 filas del DataFrame, lo que permite confirmar que los datos se cargaron correctamente y están completos.<br />
Algunas de las columnas más relevantes son:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">customerID</span></code>: identificador único de cada cliente.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gender</span></code>: género del cliente.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SeniorCitizen</span></code>: indica si el cliente es adulto mayor (1) o no (0).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Partner</span></code> y <code class="docutils literal notranslate"><span class="pre">Dependents</span></code>: muestran si el cliente tiene pareja o dependientes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tenure</span></code>: meses que el cliente ha permanecido en la compañía.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PhoneService</span></code>, <code class="docutils literal notranslate"><span class="pre">MultipleLines</span></code>, <code class="docutils literal notranslate"><span class="pre">InternetService</span></code>: servicios que tiene contratados el cliente.</p></li>
<li><p>Otras variables están relacionadas con seguridad, soporte técnico y métodos de pago.</p></li>
</ul>
<p><strong>Conclusión:</strong><br />
La descarga, lectura y almacenamiento del dataset se completaron exitosamente.<br />
Los datos están listos para iniciar el <strong>análisis exploratorio (EDA)</strong> y preparar las siguientes fases del flujo <strong>MLOps</strong>, que incluyen limpieza, transformación y modelado predictivo del abandono de clientes (<em>churn</em>).</p>
</section>
</section>
</section>
<section id="lectura-del-dataset-y-verificacion">
<h2><strong>2. Lectura del Dataset y verificación</strong><a class="headerlink" href="#lectura-del-dataset-y-verificacion" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Si guardaste parquet/csv en la celda anterior:</span>
<span class="n">RAW</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)</span><span class="o">/</span><span class="s2">&quot;data&quot;</span><span class="o">/</span><span class="s2">&quot;raw&quot;</span><span class="o">/</span><span class="s2">&quot;telco_churn.csv&quot;</span>
<span class="n">PROC</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)</span><span class="o">/</span><span class="s2">&quot;data&quot;</span><span class="o">/</span><span class="s2">&quot;processed&quot;</span><span class="o">/</span><span class="s2">&quot;telco_churn.parquet&quot;</span>

<span class="c1"># Lee preferiblemente parquet (más rápido y tipos estables)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">PROC</span><span class="p">)</span> <span class="k">if</span> <span class="n">PROC</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">RAW</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(7043, 21)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customerID</th>
      <th>gender</th>
      <th>SeniorCitizen</th>
      <th>Partner</th>
      <th>Dependents</th>
      <th>tenure</th>
      <th>PhoneService</th>
      <th>MultipleLines</th>
      <th>InternetService</th>
      <th>OnlineSecurity</th>
      <th>OnlineBackup</th>
      <th>DeviceProtection</th>
      <th>TechSupport</th>
      <th>StreamingTV</th>
      <th>StreamingMovies</th>
      <th>Contract</th>
      <th>PaperlessBilling</th>
      <th>PaymentMethod</th>
      <th>MonthlyCharges</th>
      <th>TotalCharges</th>
      <th>Churn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7590-VHVEG</td>
      <td>Female</td>
      <td>0</td>
      <td>Yes</td>
      <td>No</td>
      <td>1</td>
      <td>No</td>
      <td>No phone service</td>
      <td>DSL</td>
      <td>No</td>
      <td>Yes</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>Month-to-month</td>
      <td>Yes</td>
      <td>Electronic check</td>
      <td>29.85</td>
      <td>29.85</td>
      <td>No</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5575-GNVDE</td>
      <td>Male</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
      <td>34</td>
      <td>Yes</td>
      <td>No</td>
      <td>DSL</td>
      <td>Yes</td>
      <td>No</td>
      <td>Yes</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>One year</td>
      <td>No</td>
      <td>Mailed check</td>
      <td>56.95</td>
      <td>1889.50</td>
      <td>No</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3668-QPYBK</td>
      <td>Male</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
      <td>2</td>
      <td>Yes</td>
      <td>No</td>
      <td>DSL</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>Month-to-month</td>
      <td>Yes</td>
      <td>Mailed check</td>
      <td>53.85</td>
      <td>108.15</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7795-CFOCW</td>
      <td>Male</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
      <td>45</td>
      <td>No</td>
      <td>No phone service</td>
      <td>DSL</td>
      <td>Yes</td>
      <td>No</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>No</td>
      <td>No</td>
      <td>One year</td>
      <td>No</td>
      <td>Bank transfer (automatic)</td>
      <td>42.30</td>
      <td>1840.75</td>
      <td>No</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9237-HQITU</td>
      <td>Female</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
      <td>2</td>
      <td>Yes</td>
      <td>No</td>
      <td>Fiber optic</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>Month-to-month</td>
      <td>Yes</td>
      <td>Electronic check</td>
      <td>70.70</td>
      <td>151.65</td>
      <td>Yes</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="salida-observada">
<h3>Salida observada<a class="headerlink" href="#salida-observada" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Shape:</span> <span class="pre">(7043,</span> <span class="pre">21)</span></code><br />
→ <strong>7.043 registros</strong> y <strong>21 columnas</strong>: coincide con el tamaño esperado del dataset de churn.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">df.head()</span></code> muestra columnas clave, confirmando lectura correcta:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">customerID</span></code> (ID único),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gender</span></code>, <code class="docutils literal notranslate"><span class="pre">SeniorCitizen</span></code>, <code class="docutils literal notranslate"><span class="pre">Partner</span></code>, <code class="docutils literal notranslate"><span class="pre">Dependents</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tenure</span></code> (meses en la compañía),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PhoneService</span></code>, <code class="docutils literal notranslate"><span class="pre">MultipleLines</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">InternetService</span></code> (p. ej., <code class="docutils literal notranslate"><span class="pre">DSL</span></code>, <code class="docutils literal notranslate"><span class="pre">Fiber</span> <span class="pre">optic</span></code>),</p></li>
<li><p>y otras de seguridad/respaldo/facturación (no todas visibles en la captura).</p></li>
</ul>
</li>
</ul>
<p><strong>Conclusión</strong></p>
<p>El flujo está bien armado: intenta Parquet por rendimiento/consistencia y cae a CSV si no existe. Con la forma y la muestra inicial, los datos quedan listos para <strong>EDA</strong> y el pipeline de <strong>preprocesamiento/modelado</strong>.</p>
</section>
</section>
<section id="limpieza-de-nombres-de-columnas">
<h2><strong>3. Limpieza de nombres de columnas</strong><a class="headerlink" href="#limpieza-de-nombres-de-columnas" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Renombra columnas (por si cambiaste el paso anterior)</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">columns</span>
      <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
      <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
      <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
      <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Tipos a revisar</span>
<span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 7043 entries, 0 to 7042
Data columns (total 21 columns):
 #   Column            Non-Null Count  Dtype  
---  ------            --------------  -----  
 0   customerID        7043 non-null   object 
 1   gender            7043 non-null   object 
 2   SeniorCitizen     7043 non-null   int64  
 3   Partner           7043 non-null   object 
 4   Dependents        7043 non-null   object 
 5   tenure            7043 non-null   int64  
 6   PhoneService      7043 non-null   object 
 7   MultipleLines     7043 non-null   object 
 8   InternetService   7043 non-null   object 
 9   OnlineSecurity    7043 non-null   object 
 10  OnlineBackup      7043 non-null   object 
 11  DeviceProtection  7043 non-null   object 
 12  TechSupport       7043 non-null   object 
 13  StreamingTV       7043 non-null   object 
 14  StreamingMovies   7043 non-null   object 
 15  Contract          7043 non-null   object 
 16  PaperlessBilling  7043 non-null   object 
 17  PaymentMethod     7043 non-null   object 
 18  MonthlyCharges    7043 non-null   float64
 19  TotalCharges      7032 non-null   float64
 20  Churn             7043 non-null   object 
dtypes: float64(2), int64(2), object(17)
memory usage: 1.1+ MB
</pre></div>
</div>
</div>
</div>
<section id="interpretacion-de-la-salida-df-info">
<h3>Interpretación de la salida (<code class="docutils literal notranslate"><span class="pre">df.info()</span></code>)<a class="headerlink" href="#interpretacion-de-la-salida-df-info" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Dimensiones:</strong> <code class="docutils literal notranslate"><span class="pre">RangeIndex:</span> <span class="pre">7043</span> <span class="pre">entries</span></code> → el DataFrame tiene <strong>7.043 filas</strong>.</p></li>
<li><p><strong>Total de columnas:</strong> <strong>21</strong>.</p></li>
<li><p><strong>Tipos detectados:</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">float64(2)</span></code> → <code class="docutils literal notranslate"><span class="pre">MonthlyCharges</span></code>, <code class="docutils literal notranslate"><span class="pre">TotalCharges</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int64(2)</span></code> → <code class="docutils literal notranslate"><span class="pre">SeniorCitizen</span></code>, <code class="docutils literal notranslate"><span class="pre">tenure</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">object(17)</span></code> → resto (categóricas como <code class="docutils literal notranslate"><span class="pre">gender</span></code>, <code class="docutils literal notranslate"><span class="pre">Partner</span></code>, <code class="docutils literal notranslate"><span class="pre">InternetService</span></code>, <code class="docutils literal notranslate"><span class="pre">Churn</span></code>, etc.).</p></li>
</ul>
</li>
<li><p><strong>Valores faltantes:</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">TotalCharges</span></code> muestra <strong>7032 non-null</strong> (deberían ser 7043) → <strong>11 nulos</strong>. Suele pasar por filas con <code class="docutils literal notranslate"><span class="pre">tenure</span> <span class="pre">=</span> <span class="pre">0</span></code> que llegan vacías en CSV y se convierten en <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p></li>
<li><p>El resto de columnas reporta <strong>7043 non-null</strong> → sin nulos según <code class="docutils literal notranslate"><span class="pre">info()</span></code>.</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="conversion-de-tipos-target-binario-y-particion-de-variables-numericas-vs-categoricas">
<h2><strong>4. Conversión de tipos, target binario y partición de variables (numéricas vs. categóricas)</strong><a class="headerlink" href="#conversion-de-tipos-target-binario-y-particion-de-variables-numericas-vs-categoricas" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convertir TotalCharges a numérico (tiene espacios vacíos)</span>
<span class="k">if</span> <span class="s2">&quot;TotalCharges&quot;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;TotalCharges&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;TotalCharges&quot;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>

<span class="c1"># Target a binario 0/1</span>
<span class="n">TARGET</span> <span class="o">=</span> <span class="s2">&quot;Churn&quot;</span>
<span class="k">assert</span> <span class="n">TARGET</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="s2">&quot;No se encontró la columna &#39;Churn&#39;.&quot;</span>

<span class="n">df</span><span class="p">[</span><span class="n">TARGET</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">TARGET</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="s2">&quot;Yes&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;No&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">})</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int8&quot;</span><span class="p">)</span>

<span class="c1"># Columnas categóricas y numéricas</span>
<span class="n">cat_cols</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
            <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">ID_COL</span><span class="p">)</span> <span class="k">if</span> <span class="n">ID_COL</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">else</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">num_cols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">TARGET</span><span class="p">)</span>

<span class="n">cat_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cat_cols</span> <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="n">TARGET</span><span class="p">]</span>
<span class="n">num_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">num_cols</span> <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="n">TARGET</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Numéricas:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">num_cols</span><span class="p">),</span> <span class="n">num_cols</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Categóricas:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cat_cols</span><span class="p">),</span> <span class="n">cat_cols</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Numéricas: 4 [&#39;SeniorCitizen&#39;, &#39;tenure&#39;, &#39;MonthlyCharges&#39;, &#39;TotalCharges&#39;]
Categóricas: 15 [&#39;gender&#39;, &#39;Partner&#39;, &#39;Dependents&#39;, &#39;PhoneService&#39;, &#39;MultipleLines&#39;, &#39;InternetService&#39;, &#39;OnlineSecurity&#39;, &#39;OnlineBackup&#39;, &#39;DeviceProtection&#39;, &#39;TechSupport&#39;]
</pre></div>
</div>
</div>
</div>
<section id="que-hace-el-codigo">
<h3>Qué hace el código<a class="headerlink" href="#que-hace-el-codigo" title="Link to this heading">#</a></h3>
<ul>
<li><p><strong>Convierte <code class="docutils literal notranslate"><span class="pre">TotalCharges</span></code> a numérico</strong> forzando (<code class="docutils literal notranslate"><span class="pre">errors=&quot;coerce&quot;</span></code>) cualquier cadena vacía a <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p>
<blockquote>
<div><p>Útil porque en este dataset algunos clientes con <code class="docutils literal notranslate"><span class="pre">tenure=0</span></code> traen <code class="docutils literal notranslate"><span class="pre">TotalCharges</span></code> vacío.</p>
</div></blockquote>
</li>
<li><p><strong>Crea el <code class="docutils literal notranslate"><span class="pre">TARGET</span></code> binario</strong> a partir de <code class="docutils literal notranslate"><span class="pre">Churn</span></code> mapeando <code class="docutils literal notranslate"><span class="pre">{&quot;Yes&quot;:</span> <span class="pre">1,</span> <span class="pre">&quot;No&quot;:</span> <span class="pre">0}</span></code> y casteando a <code class="docutils literal notranslate"><span class="pre">int8</span></code> (eficiente en memoria).</p></li>
<li><p><strong>Identifica columnas categóricas y numéricas</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cat_cols</span></code> toma las de tipo <code class="docutils literal notranslate"><span class="pre">object</span></code> y opcionalmente <strong>excluye el ID</strong> si existe (<code class="docutils literal notranslate"><span class="pre">ID_COL</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_cols</span></code> toma las de tipo numérico (<code class="docutils literal notranslate"><span class="pre">np.number</span></code>) y <strong>excluye la variable objetivo</strong> (<code class="docutils literal notranslate"><span class="pre">TARGET</span></code>).</p></li>
<li><p>Se reﬁltran ambas listas para asegurar que <strong>ninguna</strong> contenga el <code class="docutils literal notranslate"><span class="pre">TARGET</span></code>.</p></li>
</ul>
</li>
<li><p><strong>Reporte rápido</strong>: imprime cuántas numéricas/categóricas hay y muestra las primeras de cada lista.</p></li>
</ul>
</section>
<section id="interpretacion-de-la-salida">
<h3>Interpretación de la salida<a class="headerlink" href="#interpretacion-de-la-salida" title="Link to this heading">#</a></h3>
<ul>
<li><p><strong>Numéricas: 4</strong> → <code class="docutils literal notranslate"><span class="pre">['SeniorCitizen',</span> <span class="pre">'tenure',</span> <span class="pre">'MonthlyCharges',</span> <span class="pre">'TotalCharges']</span></code></p>
<blockquote>
<div><p>Confirma que <code class="docutils literal notranslate"><span class="pre">TotalCharges</span></code> ya quedó numérica y que <code class="docutils literal notranslate"><span class="pre">SeniorCitizen</span></code>/<code class="docutils literal notranslate"><span class="pre">tenure</span></code> son enteras.</p>
</div></blockquote>
</li>
<li><p><strong>Categóricas: 15</strong> → empiezan por <code class="docutils literal notranslate"><span class="pre">['gender',</span> <span class="pre">'Partner',</span> <span class="pre">'Dependents',</span> <span class="pre">'PhoneService',</span> <span class="pre">'MultipleLines',</span> <span class="pre">'InternetService',</span> <span class="pre">'OnlineSecurity',</span> <span class="pre">...]</span></code></p>
<blockquote>
<div><p>Son las que luego irán a <strong>codificación</strong> (One-Hot/Ordinal) en el pipeline.</p>
</div></blockquote>
</li>
</ul>
</section>
<section id="importancia">
<h3>Importancia<a class="headerlink" href="#importancia" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Tener <code class="docutils literal notranslate"><span class="pre">Churn</span></code> como <strong>0/1</strong> simplifica métricas y modelos (Logística, Árboles, SVM, etc.).</p></li>
<li><p>Separar <strong>numéricas</strong> y <strong>categóricas</strong> desde temprano permite armar un <code class="docutils literal notranslate"><span class="pre">ColumnTransformer</span></code> claro y reproducible.</p></li>
<li><p>El <code class="docutils literal notranslate"><span class="pre">coerce</span></code> en <code class="docutils literal notranslate"><span class="pre">TotalCharges</span></code> evita errores de parseo y deja listos los <strong>pasos de imputación</strong> (p. ej., mediana para nulos).</p></li>
</ul>
</section>
</section>
<section id="conteo-de-valores-faltantes-por-columna">
<h2><strong>5. Conteo de valores faltantes por columna</strong><a class="headerlink" href="#conteo-de-valores-faltantes-por-columna" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Conteo y % de faltantes por columna</span>
<span class="n">na_counts</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">na_pct</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">faltantes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;faltantes&quot;</span><span class="p">:</span> <span class="n">na_counts</span><span class="p">,</span> <span class="s2">&quot;%&quot;</span><span class="p">:</span> <span class="n">na_pct</span><span class="p">})</span>
<span class="n">faltantes</span><span class="p">[</span><span class="n">faltantes</span><span class="p">[</span><span class="s2">&quot;faltantes&quot;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>faltantes</th>
      <th>%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>TotalCharges</th>
      <td>11</td>
      <td>0.16</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Resultado observado:</p>
<ul>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">TotalCharges</span></code> → 11 faltantes (0.16%)</strong></p></li>
</ul>
</li>
</ul>
</section>
<section id="distribucion-del-target-churn-porcentaje-y-conteo-implicaciones-de-desbalance">
<h2><strong>6. Distribución del target <code class="docutils literal notranslate"><span class="pre">Churn</span></code> (porcentaje y conteo) + implicaciones de desbalance</strong><a class="headerlink" href="#distribucion-del-target-churn-porcentaje-y-conteo-implicaciones-de-desbalance" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">TARGET</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
      <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span><span class="s2">&quot;No Churn&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="s2">&quot;Churn&quot;</span><span class="p">})</span>
      <span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribución del Target (%)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;%&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">patches</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">p</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span><span class="o">+</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span><span class="o">+</span><span class="mf">0.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">FIGS</span><span class="o">/</span><span class="s2">&quot;eda_target_balance.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">df</span><span class="p">[</span><span class="n">TARGET</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/287f9cf1da6f6da91d64535376a97eb8e8438a856c14d16aab0e4bacff05d6a7.png" src="_images/287f9cf1da6f6da91d64535376a97eb8e8438a856c14d16aab0e4bacff05d6a7.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Churn
0    5174
1    1869
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Este bloque:</p>
<ul class="simple">
<li><p>Calcula la <strong>proporción</strong> de cada clase con <code class="docutils literal notranslate"><span class="pre">df[TARGET].value_counts(normalize=True)</span></code>.</p></li>
<li><p>Renombra las clases a <strong><code class="docutils literal notranslate"><span class="pre">No</span> <span class="pre">Churn</span></code></strong> (0) y <strong><code class="docutils literal notranslate"><span class="pre">Churn</span></code></strong> (1), multiplica por <strong>100</strong> y grafica un <strong>barras</strong> (<code class="docutils literal notranslate"><span class="pre">kind=&quot;bar&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">figsize=(5,3)</span></code>).</p></li>
<li><p>Anota etiquetas <strong>%</strong> sobre cada barra para facilitar la lectura.</p></li>
<li><p>Ajusta el layout, guarda la figura en <code class="docutils literal notranslate"><span class="pre">FIGS/eda_target_balance.png</span></code> (dpi=140) y muestra el gráfico.</p></li>
<li><p>Finalmente imprime el <strong>conteo absoluto</strong> de clases con <code class="docutils literal notranslate"><span class="pre">df[TARGET].value_counts()</span></code>.</p></li>
</ul>
<section id="id1">
<h3>Interpretación de la salida<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Gráfico</strong>: muestra que ~<strong>73.5%</strong> de los registros son <strong>No Churn</strong> y ~<strong>26.5%</strong> son <strong>Churn</strong>.</p></li>
<li><p><strong>Conteos</strong>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">(No</span> <span class="pre">Churn)</span></code>: <strong>5,174</strong></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">(Churn)</span></code>: <strong>1,869</strong></p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="resumen-estadistico-numericas-cardinalidad-y-top-frecuencias-categoricas">
<h2><strong>7. Resumen estadístico (numéricas) + cardinalidad y top-frecuencias (categóricas)</strong><a class="headerlink" href="#resumen-estadistico-numericas-cardinalidad-y-top-frecuencias-categoricas" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Numéricas</span>
<span class="n">desc_num</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">num_cols</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">desc_num</span><span class="p">)</span>

<span class="c1"># Categóricas: cardinalidad y top frecuencias</span>
<span class="k">def</span><span class="w"> </span><span class="nf">freq_table</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">vc</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s2">&quot;cardinalidad&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">vc</span><span class="o">.</span><span class="n">size</span><span class="p">],</span>
        <span class="s2">&quot;top_k&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="n">vc</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">k</span><span class="p">))]</span>
    <span class="p">})</span>

<span class="n">tabla_cat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">freq_table</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">c</span><span class="p">])</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cat_cols</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">tabla_cat</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">cat_cols</span>
<span class="n">display</span><span class="p">(</span><span class="n">tabla_cat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>SeniorCitizen</th>
      <td>7043.0</td>
      <td>0.162147</td>
      <td>0.368612</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.0000</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>tenure</th>
      <td>7043.0</td>
      <td>32.371149</td>
      <td>24.559481</td>
      <td>0.00</td>
      <td>9.00</td>
      <td>29.000</td>
      <td>55.0000</td>
      <td>72.00</td>
    </tr>
    <tr>
      <th>MonthlyCharges</th>
      <td>7043.0</td>
      <td>64.761692</td>
      <td>30.090047</td>
      <td>18.25</td>
      <td>35.50</td>
      <td>70.350</td>
      <td>89.8500</td>
      <td>118.75</td>
    </tr>
    <tr>
      <th>TotalCharges</th>
      <td>7032.0</td>
      <td>2283.300441</td>
      <td>2266.771362</td>
      <td>18.80</td>
      <td>401.45</td>
      <td>1397.475</td>
      <td>3794.7375</td>
      <td>8684.80</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cardinalidad</th>
      <th>top_k</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>gender</th>
      <td>2</td>
      <td>{'Male': 3555, 'Female': 3488}</td>
    </tr>
    <tr>
      <th>Partner</th>
      <td>2</td>
      <td>{'No': 3641, 'Yes': 3402}</td>
    </tr>
    <tr>
      <th>Dependents</th>
      <td>2</td>
      <td>{'No': 4933, 'Yes': 2110}</td>
    </tr>
    <tr>
      <th>PhoneService</th>
      <td>2</td>
      <td>{'Yes': 6361, 'No': 682}</td>
    </tr>
    <tr>
      <th>MultipleLines</th>
      <td>3</td>
      <td>{'No': 3390, 'Yes': 2971, 'No phone service': ...</td>
    </tr>
    <tr>
      <th>InternetService</th>
      <td>3</td>
      <td>{'Fiber optic': 3096, 'DSL': 2421, 'No': 1526}</td>
    </tr>
    <tr>
      <th>OnlineSecurity</th>
      <td>3</td>
      <td>{'No': 3498, 'Yes': 2019, 'No internet service...</td>
    </tr>
    <tr>
      <th>OnlineBackup</th>
      <td>3</td>
      <td>{'No': 3088, 'Yes': 2429, 'No internet service...</td>
    </tr>
    <tr>
      <th>DeviceProtection</th>
      <td>3</td>
      <td>{'No': 3095, 'Yes': 2422, 'No internet service...</td>
    </tr>
    <tr>
      <th>TechSupport</th>
      <td>3</td>
      <td>{'No': 3473, 'Yes': 2044, 'No internet service...</td>
    </tr>
    <tr>
      <th>StreamingTV</th>
      <td>3</td>
      <td>{'No': 2810, 'Yes': 2707, 'No internet service...</td>
    </tr>
    <tr>
      <th>StreamingMovies</th>
      <td>3</td>
      <td>{'No': 2785, 'Yes': 2732, 'No internet service...</td>
    </tr>
    <tr>
      <th>Contract</th>
      <td>3</td>
      <td>{'Month-to-month': 3875, 'Two year': 1695, 'On...</td>
    </tr>
    <tr>
      <th>PaperlessBilling</th>
      <td>2</td>
      <td>{'Yes': 4171, 'No': 2872}</td>
    </tr>
    <tr>
      <th>PaymentMethod</th>
      <td>4</td>
      <td>{'Electronic check': 2365, 'Mailed check': 161...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Este bloque:</p>
<ul class="simple">
<li><p><strong>Numéricas:</strong> <code class="docutils literal notranslate"><span class="pre">df[num_cols].describe().T</span></code> produce conteos, media, desviación estándar y cuantiles (25/50/75%) para cada variable numérica.</p></li>
<li><p><strong>Categóricas:</strong> define <code class="docutils literal notranslate"><span class="pre">freq_table(s,</span> <span class="pre">k=5)</span></code> que:</p>
<ul>
<li><p>calcula <code class="docutils literal notranslate"><span class="pre">value_counts(dropna=False)</span></code>,</p></li>
<li><p>devuelve la <strong>cardinalidad</strong> (número de categorías distintas) y un diccionario con el <strong>top-k</strong> valores más frecuentes,</p></li>
<li><p>concatena los resultados para todas las columnas en <code class="docutils literal notranslate"><span class="pre">cat_cols</span></code> y los muestra como tabla.</p></li>
</ul>
</li>
</ul>
<section id="id2">
<h3>Interpretación de la salida<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<section id="numericas-describe-t">
<h4>1) Numéricas (<code class="docutils literal notranslate"><span class="pre">describe().T</span></code>)<a class="headerlink" href="#numericas-describe-t" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>SeniorCitizen</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">count=7043</span></code>, <code class="docutils literal notranslate"><span class="pre">mean≈0.162</span></code>, <code class="docutils literal notranslate"><span class="pre">std≈0.369</span></code>, <code class="docutils literal notranslate"><span class="pre">min=0</span></code>, <code class="docutils literal notranslate"><span class="pre">max=1</span></code> → variable binaria bien leída.</p></li>
</ul>
</li>
<li><p><strong>tenure</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">mean≈32.37</span></code> meses, IQR <code class="docutils literal notranslate"><span class="pre">9–55</span></code>, <code class="docutils literal notranslate"><span class="pre">max=72</span></code>. Hay clientes recientes (<code class="docutils literal notranslate"><span class="pre">min=0</span></code>) y de larga data (<code class="docutils literal notranslate"><span class="pre">&gt;60</span></code>).</p></li>
</ul>
</li>
<li><p><strong>MonthlyCharges</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">mean≈64.76</span></code>, IQR <code class="docutils literal notranslate"><span class="pre">35.5–89.85</span></code>, <code class="docutils literal notranslate"><span class="pre">max≈118.75</span></code>. Rango coherente con planes/servicios.</p></li>
</ul>
</li>
<li><p><strong>TotalCharges</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">count=7032</span></code> (→ <strong>11 nulos</strong>), <code class="docutils literal notranslate"><span class="pre">median≈1397.5</span></code>, IQR <code class="docutils literal notranslate"><span class="pre">401–3795</span></code>, <code class="docutils literal notranslate"><span class="pre">max≈8684.8</span></code>. Distribución amplia; revisar posibles valores altos (outliers legítimos por alta permanencia/servicios).</p></li>
</ul>
</li>
</ul>
<blockquote>
<div><p>Nota: el <code class="docutils literal notranslate"><span class="pre">count</span></code> menor en <code class="docutils literal notranslate"><span class="pre">TotalCharges</span></code> confirma los faltantes detectados antes.</p>
</div></blockquote>
</section>
<section id="categoricas-cardinalidad-y-top-k">
<h4>2) Categóricas (cardinalidad y top-k)<a class="headerlink" href="#categoricas-cardinalidad-y-top-k" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>Cardinalidades típicas</strong>:</p>
<ul>
<li><p>2 niveles: <code class="docutils literal notranslate"><span class="pre">gender</span></code>, <code class="docutils literal notranslate"><span class="pre">Partner</span></code>, <code class="docutils literal notranslate"><span class="pre">Dependents</span></code>, <code class="docutils literal notranslate"><span class="pre">PhoneService</span></code>, <code class="docutils literal notranslate"><span class="pre">PaperlessBilling</span></code>…</p></li>
<li><p>3 niveles: <code class="docutils literal notranslate"><span class="pre">MultipleLines</span></code> (<code class="docutils literal notranslate"><span class="pre">No</span></code>, <code class="docutils literal notranslate"><span class="pre">Yes</span></code>, <code class="docutils literal notranslate"><span class="pre">No</span> <span class="pre">phone</span> <span class="pre">service</span></code>), <code class="docutils literal notranslate"><span class="pre">InternetService</span></code> (<code class="docutils literal notranslate"><span class="pre">Fiber</span> <span class="pre">optic</span></code>, <code class="docutils literal notranslate"><span class="pre">DSL</span></code>, <code class="docutils literal notranslate"><span class="pre">No</span></code>), <code class="docutils literal notranslate"><span class="pre">OnlineSecurity/Backup/DeviceProtection/TechSupport/StreamingTV/StreamingMovies</span></code> (cada una con <code class="docutils literal notranslate"><span class="pre">Yes</span></code>, <code class="docutils literal notranslate"><span class="pre">No</span></code>, <code class="docutils literal notranslate"><span class="pre">No</span> <span class="pre">internet</span> <span class="pre">service</span></code>).</p></li>
<li><p>3 niveles: <code class="docutils literal notranslate"><span class="pre">Contract</span></code> (<code class="docutils literal notranslate"><span class="pre">Month-to-month</span></code>, <code class="docutils literal notranslate"><span class="pre">Two</span> <span class="pre">year</span></code>, <code class="docutils literal notranslate"><span class="pre">One</span> <span class="pre">year</span></code>).</p></li>
<li><p>4 niveles: <code class="docutils literal notranslate"><span class="pre">PaymentMethod</span></code> (p. ej., <code class="docutils literal notranslate"><span class="pre">Electronic</span> <span class="pre">check</span></code>, <code class="docutils literal notranslate"><span class="pre">Mailed</span> <span class="pre">check</span></code>, etc.).</p></li>
</ul>
</li>
<li><p><strong>Top-frecuencias destacadas</strong> (muestran la moda de cada variable):</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">gender</span></code>: <code class="docutils literal notranslate"><span class="pre">Male</span></code> y <code class="docutils literal notranslate"><span class="pre">Female</span></code> casi balanceados.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PhoneService</span></code>: predominan los <strong>Yes</strong> (más de 6k).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">InternetService</span></code>: <strong>Fiber optic</strong> es el más común, seguido de <code class="docutils literal notranslate"><span class="pre">DSL</span></code>; existe la categoría <strong>No</strong>.</p></li>
<li><p>Servicios adicionales (<code class="docutils literal notranslate"><span class="pre">OnlineSecurity</span></code>, <code class="docutils literal notranslate"><span class="pre">OnlineBackup</span></code>, etc.): la clase <strong>No</strong> domina y aparece la categoría <strong>No internet service</strong> (importante para codificación).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Contract</span></code>: mayoría <strong>Month-to-month</strong> (≈3.8k), menor proporción en contratos de mayor plazo.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PaymentMethod</span></code>: <strong>Electronic check</strong> es la forma más usada.</p></li>
</ul>
</li>
</ul>
</section>
</section>
</section>
<section id="visualizacion-univariada-distribuciones-numericas-y-categoricas">
<h2><strong>8. Visualización univariada: Distribuciones numéricas y categóricas</strong><a class="headerlink" href="#visualizacion-univariada-distribuciones-numericas-y-categoricas" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Histogramas/KDE para numéricas</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">num_cols</span><span class="p">)</span>
<span class="n">cols</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="n">cols</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">cols</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">rows</span><span class="o">*</span><span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">num_cols</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">FIGS</span><span class="o">/</span><span class="s2">&quot;eda_hist_num.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Barras para categóricas (solo top 10 niveles si hay muchos)</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cat_cols</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mf">3.5</span><span class="p">))</span>
    <span class="n">vc</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">vc</span> <span class="o">=</span> <span class="n">vc</span> <span class="k">if</span> <span class="n">vc</span><span class="o">.</span><span class="n">size</span><span class="o">&lt;=</span><span class="mi">10</span> <span class="k">else</span> <span class="n">vc</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">vc</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">vc</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2"> (top niveles)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">FIGS</span><span class="o">/</span><span class="sa">f</span><span class="s2">&quot;eda_bar_</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a2b31179f170e1188c989cc48f48caa6eeda52f90350f0dfe33c9c5e5aa7664d.png" src="_images/a2b31179f170e1188c989cc48f48caa6eeda52f90350f0dfe33c9c5e5aa7664d.png" />
<img alt="_images/eb421437224ec3a3e5c16c31fa59a15432500af420de2332165a8a0918a7b4f4.png" src="_images/eb421437224ec3a3e5c16c31fa59a15432500af420de2332165a8a0918a7b4f4.png" />
<img alt="_images/1cd167bc89766e71a94b5719bac7b489877b5d42146c7c77ecbc9b1716ecf78e.png" src="_images/1cd167bc89766e71a94b5719bac7b489877b5d42146c7c77ecbc9b1716ecf78e.png" />
<img alt="_images/fec651b39f27219ef5ef115dbbc33788a9b195e1bccefed5a7e2e855daf24136.png" src="_images/fec651b39f27219ef5ef115dbbc33788a9b195e1bccefed5a7e2e855daf24136.png" />
<img alt="_images/9fa762d81d6bb6edccbfebf1bac890d9115394bec64bfac136fe3c7e6199bcf6.png" src="_images/9fa762d81d6bb6edccbfebf1bac890d9115394bec64bfac136fe3c7e6199bcf6.png" />
<img alt="_images/46f9ee3a8a5e0759315039f38c386811d2782b16cdb41c27b33e7229502d5e27.png" src="_images/46f9ee3a8a5e0759315039f38c386811d2782b16cdb41c27b33e7229502d5e27.png" />
<img alt="_images/ef3b7a2a9987b1533296c67f332f7a52d2f941677c0786ed1735f0ea51aaab98.png" src="_images/ef3b7a2a9987b1533296c67f332f7a52d2f941677c0786ed1735f0ea51aaab98.png" />
<img alt="_images/11e1e894e868ea71f08df1a80a0decffa5b448137c35f536b06473638b009840.png" src="_images/11e1e894e868ea71f08df1a80a0decffa5b448137c35f536b06473638b009840.png" />
<img alt="_images/82e3f7111678e8836d5af4801edacb1c996c28f2e0f3211eca4f9b4ab3f7b0a4.png" src="_images/82e3f7111678e8836d5af4801edacb1c996c28f2e0f3211eca4f9b4ab3f7b0a4.png" />
<img alt="_images/c6b21e1fec918db9cacd7bca03366c5ae2f872c6e49f1428dd3c3433441154b0.png" src="_images/c6b21e1fec918db9cacd7bca03366c5ae2f872c6e49f1428dd3c3433441154b0.png" />
<img alt="_images/4cf098c90734340f3e40043b2276b6f71f0b4896ad1568ddb51055c3a03f036a.png" src="_images/4cf098c90734340f3e40043b2276b6f71f0b4896ad1568ddb51055c3a03f036a.png" />
<img alt="_images/2c3463827f8673ba9b5ddc3d7dfef5ad32267be3f244adbe00ae9a2fb6edb598.png" src="_images/2c3463827f8673ba9b5ddc3d7dfef5ad32267be3f244adbe00ae9a2fb6edb598.png" />
<img alt="_images/82c27c2ea49a91e0699d9ec917990addaf49b3ff796613953b0f478be9973c4c.png" src="_images/82c27c2ea49a91e0699d9ec917990addaf49b3ff796613953b0f478be9973c4c.png" />
<img alt="_images/0d1e572a0997a124cabc70c6e25d49f0e94138f1a73439881b0bd1ae36594fcc.png" src="_images/0d1e572a0997a124cabc70c6e25d49f0e94138f1a73439881b0bd1ae36594fcc.png" />
<img alt="_images/409789a70d252c24fcb62ddf2ae0aa4e36de8a931ee28c4994af9ab037236025.png" src="_images/409789a70d252c24fcb62ddf2ae0aa4e36de8a931ee28c4994af9ab037236025.png" />
<img alt="_images/5cb42d702bd77668920839673fd7feb74c229cb52c9aee0f53474e1847f67822.png" src="_images/5cb42d702bd77668920839673fd7feb74c229cb52c9aee0f53474e1847f67822.png" />
</div>
</div>
<section id="interpretacion-de-los-resultados">
<h3>Interpretación de los resultados<a class="headerlink" href="#interpretacion-de-los-resultados" title="Link to this heading">#</a></h3>
<section id="variables-numericas">
<h4>Variables numéricas<a class="headerlink" href="#variables-numericas" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p><strong>SeniorCitizen</strong></p>
<ul class="simple">
<li><p>Distribución binaria (0 y 1), con clara mayoría de clientes <strong>no mayores</strong>.</p></li>
<li><p>Picos definidos: la mayoría son jóvenes, con minoría significativa de adultos mayores.</p></li>
</ul>
</li>
<li><p><strong>tenure (meses de permanencia)</strong></p>
<ul class="simple">
<li><p>Distribución <strong>bimodal</strong>:</p>
<ul>
<li><p>Gran cantidad de clientes nuevos (<code class="docutils literal notranslate"><span class="pre">tenure</span> <span class="pre">≈</span> <span class="pre">0</span></code>),</p></li>
<li><p>Otro grupo con larga permanencia (<code class="docutils literal notranslate"><span class="pre">tenure</span> <span class="pre">&gt;</span> <span class="pre">60</span></code>).</p></li>
</ul>
</li>
<li><p>Indica posible patrón de <strong>churn temprano</strong> o <strong>fidelidad alta</strong> en extremos.</p></li>
</ul>
</li>
<li><p><strong>MonthlyCharges (cargo mensual)</strong></p>
<ul class="simple">
<li><p>Distribución relativamente amplia, con mayor densidad entre <strong>70 y 100 USD</strong>.</p></li>
<li><p>Sugiere distintos tipos de planes o servicios contratados.</p></li>
</ul>
</li>
<li><p><strong>TotalCharges (cargo total)</strong></p>
<ul class="simple">
<li><p>Distribución <strong>fuertemente sesgada a la derecha</strong>, como era de esperarse:</p>
<ul>
<li><p>Clientes nuevos tienen valores bajos,</p></li>
<li><p>Clientes antiguos acumulan cargos altos.</p></li>
</ul>
</li>
</ul>
</li>
</ol>
<blockquote>
<div><p>Estas visualizaciones ayudan a detectar outliers, sesgos de distribución y a definir transformaciones (como escalado o log-transformaciones).</p>
</div></blockquote>
</section>
<section id="variables-categoricas-barras">
<h4>Variables categóricas (barras)<a class="headerlink" href="#variables-categoricas-barras" title="Link to this heading">#</a></h4>
<ol class="arabic">
<li><p><strong>gender</strong> → Distribución casi 50/50 entre <em>Male</em> y <em>Female</em>.</p></li>
<li><p><strong>Partner</strong> → Ligero predominio del <em>No</em> (sin pareja).</p></li>
<li><p><strong>Dependents</strong> → Mayoría <em>No</em>, pocos con dependientes.</p></li>
<li><p><strong>PhoneService</strong> → Alta proporción de <em>Yes</em>.</p></li>
<li><p><strong>MultipleLines</strong> → Predomina <em>No</em>, seguido de <em>Yes</em> y menor número sin servicio telefónico.</p></li>
<li><p><strong>InternetService</strong> → Más usuarios con <em>Fiber optic</em>, luego <em>DSL</em>, y algunos <em>No</em>.</p></li>
<li><p><strong>OnlineSecurity / OnlineBackup / DeviceProtection / TechSupport</strong> →<br />
En todas domina <em>No</em>, seguido de <em>Yes</em>, y presencia notable de <em>No internet service</em>.</p>
<blockquote>
<div><p>Muestra que muchos usuarios no tienen servicios adicionales activos.</p>
</div></blockquote>
</li>
<li><p><strong>StreamingTV / StreamingMovies</strong> → Distribución equilibrada entre <em>Yes</em> y <em>No</em>, con menor grupo <em>No internet service</em>.</p></li>
<li><p><strong>Contract</strong> → Predominio de <em>Month-to-month</em>; contratos <em>Two year</em> y <em>One year</em> son menos frecuentes.</p></li>
<li><p><strong>PaperlessBilling</strong> → Mayoría <em>Yes</em>, coherente con la digitalización de cobros.</p></li>
<li><p><strong>PaymentMethod</strong> → Destaca <em>Electronic check</em> como principal método, seguido por <em>Mailed check</em> y transferencias automáticas.</p></li>
</ol>
</section>
</section>
<section id="conclusion">
<h3>Conclusión<a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Variables numéricas:</strong> se observa alta concentración en valores bajos y asimetrías (sesgo positivo en <code class="docutils literal notranslate"><span class="pre">TotalCharges</span></code> y <code class="docutils literal notranslate"><span class="pre">MonthlyCharges</span></code>).</p></li>
<li><p><strong>Variables categóricas:</strong> predominan servicios básicos y contratos cortos (<em>Month-to-month</em>), lo cual puede estar correlacionado con <strong>mayor churn</strong>.</p></li>
<li><p>Estas visualizaciones constituyen la base del <strong>EDA univariado</strong>, necesarias para:</p>
<ul>
<li><p>comprender la estructura general del dataset,</p></li>
<li><p>decidir transformaciones y normalizaciones,</p></li>
<li><p>preparar la siguiente fase de análisis bivariado con <code class="docutils literal notranslate"><span class="pre">Churn</span></code> como variable objetivo.</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="relacion-de-variables-numericas-con-churn-violines-prueba-de-mannwhitney">
<h2><strong>9. Relación de variables numéricas con <code class="docutils literal notranslate"><span class="pre">Churn</span></code>: violines + prueba de Mann–Whitney</strong><a class="headerlink" href="#relacion-de-variables-numericas-con-churn-violines-prueba-de-mannwhitney" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Boxplot/violin por target</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">num_cols</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mf">3.5</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">TARGET</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">inner</span><span class="o">=</span><span class="s2">&quot;quartile&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">TARGET</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">FIGS</span><span class="o">/</span><span class="sa">f</span><span class="s2">&quot;eda_violin_</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Prueba estadística: Mann-Whitney (no asume normalidad)</span>
<span class="n">tests_num</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">num_cols</span><span class="p">:</span>
    <span class="n">g0</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">TARGET</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="n">g1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">TARGET</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="n">stat</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">g0</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;two-sided&quot;</span><span class="p">)</span>
    <span class="n">tests_num</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="n">c</span><span class="p">,</span> <span class="s2">&quot;U_stat&quot;</span><span class="p">:</span> <span class="n">stat</span><span class="p">,</span> <span class="s2">&quot;p_value&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">})</span>
<span class="n">tests_num</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tests_num</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;p_value&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">tests_num</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/79217f94d7e0cbf975c46322654f090fcab90443436af70bcf0b8c517cd981b3.png" src="_images/79217f94d7e0cbf975c46322654f090fcab90443436af70bcf0b8c517cd981b3.png" />
<img alt="_images/b61c3eb3013a60f478fb2a49e9a32c8b7f952ed7d7139c25fd0a42c21593b7f8.png" src="_images/b61c3eb3013a60f478fb2a49e9a32c8b7f952ed7d7139c25fd0a42c21593b7f8.png" />
<img alt="_images/b4c558d8163cc606112ba66a6ea79df45e1b4b8738d7e13dbf994f5efecf3260.png" src="_images/b4c558d8163cc606112ba66a6ea79df45e1b4b8738d7e13dbf994f5efecf3260.png" />
<img alt="_images/564b97fcd44ca4673c384cc723fbaa47713874be6c4ffc0c7a503f690ed6aff5.png" src="_images/564b97fcd44ca4673c384cc723fbaa47713874be6c4ffc0c7a503f690ed6aff5.png" />
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>variable</th>
      <th>U_stat</th>
      <th>p_value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>tenure</td>
      <td>7154668.0</td>
      <td>2.419636e-208</td>
    </tr>
    <tr>
      <th>3</th>
      <td>TotalCharges</td>
      <td>6288982.0</td>
      <td>1.995985e-84</td>
    </tr>
    <tr>
      <th>2</th>
      <td>MonthlyCharges</td>
      <td>3667080.5</td>
      <td>3.311628e-54</td>
    </tr>
    <tr>
      <th>0</th>
      <td>SeniorCitizen</td>
      <td>4226068.0</td>
      <td>9.588357e-37</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="interpretacion-de-los-violines">
<h3>Interpretación de los violines<a class="headerlink" href="#interpretacion-de-los-violines" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>SeniorCitizen vs Churn</strong></p>
<ul class="simple">
<li><p>El violín de <code class="docutils literal notranslate"><span class="pre">Churn</span> <span class="pre">=</span> <span class="pre">1</span></code> muestra <strong>mayor masa en 1</strong> (adultos mayores).</p></li>
<li><p>Indica que los clientes senior tienden a <strong>churnear más</strong> que los no-senior.</p></li>
</ul>
</li>
<li><p><strong>tenure vs Churn</strong></p>
<ul class="simple">
<li><p>Para <code class="docutils literal notranslate"><span class="pre">Churn</span> <span class="pre">=</span> <span class="pre">0</span></code>, el violín se extiende a valores <strong>altos de tenure</strong> (clientes fieles de muchos meses).</p></li>
<li><p>Para <code class="docutils literal notranslate"><span class="pre">Churn</span> <span class="pre">=</span> <span class="pre">1</span></code>, la distribución está más concentrada en <strong>tenures bajos</strong>.</p></li>
<li><p>Sugiere que quienes abandonan suelen llevar <strong>poco tiempo</strong> con la compañía.</p></li>
</ul>
</li>
<li><p><strong>MonthlyCharges vs Churn</strong></p>
<ul class="simple">
<li><p>En <code class="docutils literal notranslate"><span class="pre">Churn</span> <span class="pre">=</span> <span class="pre">1</span></code>, la densidad se desplaza hacia <strong>cargos mensuales más altos</strong>.</p></li>
<li><p>Los clientes que pagan más al mes parecen estar <strong>más insatisfechos</strong> o más propensos a irse.</p></li>
</ul>
</li>
<li><p><strong>TotalCharges vs Churn</strong></p>
<ul class="simple">
<li><p>Ambos grupos tienen colas largas, pero:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Churn</span> <span class="pre">=</span> <span class="pre">0</span></code> muestra más clientes con <strong>TotalCharges muy altos</strong> (lógica: larga permanencia).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Churn</span> <span class="pre">=</span> <span class="pre">1</span></code> está más concentrado en valores <strong>bajos/medios</strong>.</p></li>
</ul>
</li>
<li><p>Refuerza la idea de que el churn ocurre más en los primeros periodos del ciclo de vida.</p></li>
</ul>
</li>
</ol>
</section>
<section id="resultados-de-mannwhitney">
<h3>Resultados de Mann–Whitney<a class="headerlink" href="#resultados-de-mannwhitney" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Todos los <strong>p-values son extremadamente pequeños</strong> (≪ 0.05).</p></li>
<li><p>Conclusión estadística:</p>
<ul>
<li><p>Para todas las variables numéricas (<code class="docutils literal notranslate"><span class="pre">tenure</span></code>, <code class="docutils literal notranslate"><span class="pre">TotalCharges</span></code>, <code class="docutils literal notranslate"><span class="pre">MonthlyCharges</span></code>, <code class="docutils literal notranslate"><span class="pre">SeniorCitizen</span></code>), <strong>rechazamos la hipótesis nula</strong> de que las distribuciones son iguales entre <code class="docutils literal notranslate"><span class="pre">Churn</span> <span class="pre">=</span> <span class="pre">0</span></code> y <code class="docutils literal notranslate"><span class="pre">Churn</span> <span class="pre">=</span> <span class="pre">1</span></code>.</p></li>
<li><p>Es decir, estas variables <strong>sí tienen diferencias significativas</strong> entre clientes que se quedan y los que abandonan.</p></li>
</ul>
</li>
</ul>
</section>
<section id="conclusion-general">
<h3>Conclusión general<a class="headerlink" href="#conclusion-general" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Los violines + Mann–Whitney confirman que las cuatro variables numéricas son <strong>fuertes candidatas</strong> para el modelo de churn:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">tenure</span></code> y <code class="docutils literal notranslate"><span class="pre">TotalCharges</span></code> capturan el ciclo de vida del cliente,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MonthlyCharges</span></code> refleja la carga económica,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SeniorCitizen</span></code> aporta información demográfica.</p></li>
</ul>
</li>
<li><p>En la fase de modelado, vale la pena:</p>
<ul>
<li><p>Incluirlas todas,</p></li>
<li><p>Evaluar posibles transformaciones (por ejemplo, escalado),</p></li>
<li><p>Explorar interacciones con las variables categóricas y con el tipo de contrato.</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="prueba-chi-cuadrado-y-barras-apiladas-por-categoria">
<h2><strong>10. Prueba Chi-cuadrado y Barras Apiladas por Categoría</strong><a class="headerlink" href="#prueba-chi-cuadrado-y-barras-apiladas-por-categoria" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chi_rows</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cat_cols</span><span class="p">:</span>
    <span class="n">ct</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">TARGET</span><span class="p">])</span>
    <span class="c1"># Evitar errores cuando alguna categoría tiene 0</span>
    <span class="k">if</span> <span class="n">ct</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ct</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">chi2</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">dof</span><span class="p">,</span> <span class="n">exp</span> <span class="o">=</span> <span class="n">chi2_contingency</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>
        <span class="n">chi_rows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="n">c</span><span class="p">,</span> <span class="s2">&quot;chi2&quot;</span><span class="p">:</span> <span class="n">chi2</span><span class="p">,</span> <span class="s2">&quot;p_value&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">,</span> <span class="s2">&quot;dof&quot;</span><span class="p">:</span> <span class="n">dof</span><span class="p">})</span>
<span class="n">chi_cat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">chi_rows</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;p_value&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">chi_cat</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>

<span class="c1"># Barras apiladas por target (proporciones)</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cat_cols</span><span class="p">:</span>
    <span class="n">prop</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">c</span><span class="p">)[</span><span class="n">TARGET</span><span class="p">]</span>
              <span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
              <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;prop&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">())</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mf">3.5</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">prop</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;prop&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="n">TARGET</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Proporción de </span><span class="si">{</span><span class="n">TARGET</span><span class="si">}</span><span class="s2"> por </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">FIGS</span><span class="o">/</span><span class="sa">f</span><span class="s2">&quot;eda_prop_</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>variable</th>
      <th>chi2</th>
      <th>p_value</th>
      <th>dof</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12</th>
      <td>Contract</td>
      <td>1184.596572</td>
      <td>5.863038e-258</td>
      <td>2</td>
    </tr>
    <tr>
      <th>6</th>
      <td>OnlineSecurity</td>
      <td>849.998968</td>
      <td>2.661150e-185</td>
      <td>2</td>
    </tr>
    <tr>
      <th>9</th>
      <td>TechSupport</td>
      <td>828.197068</td>
      <td>1.443084e-180</td>
      <td>2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>InternetService</td>
      <td>732.309590</td>
      <td>9.571788e-160</td>
      <td>2</td>
    </tr>
    <tr>
      <th>14</th>
      <td>PaymentMethod</td>
      <td>648.142327</td>
      <td>3.682355e-140</td>
      <td>3</td>
    </tr>
    <tr>
      <th>7</th>
      <td>OnlineBackup</td>
      <td>601.812790</td>
      <td>2.079759e-131</td>
      <td>2</td>
    </tr>
    <tr>
      <th>8</th>
      <td>DeviceProtection</td>
      <td>558.419369</td>
      <td>5.505219e-122</td>
      <td>2</td>
    </tr>
    <tr>
      <th>11</th>
      <td>StreamingMovies</td>
      <td>375.661479</td>
      <td>2.667757e-82</td>
      <td>2</td>
    </tr>
    <tr>
      <th>10</th>
      <td>StreamingTV</td>
      <td>374.203943</td>
      <td>5.528994e-82</td>
      <td>2</td>
    </tr>
    <tr>
      <th>13</th>
      <td>PaperlessBilling</td>
      <td>258.277649</td>
      <td>4.073355e-58</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="_images/50dc3ca36675f5cbbde24b13a665f90dd700e49d5f4f6ffb18e6e058d7b728d9.png" src="_images/50dc3ca36675f5cbbde24b13a665f90dd700e49d5f4f6ffb18e6e058d7b728d9.png" />
<img alt="_images/f56e71df0cb062a15af53336af543e2f932f24804b6ff2d57d733f169ded239d.png" src="_images/f56e71df0cb062a15af53336af543e2f932f24804b6ff2d57d733f169ded239d.png" />
<img alt="_images/c59591022c72d6615298398900653a63575aeaf0a56483ecf85085c855801243.png" src="_images/c59591022c72d6615298398900653a63575aeaf0a56483ecf85085c855801243.png" />
<img alt="_images/6d20074d2b2a27acc78df54e6e5fe03601a09067fdb03fecdec148cb56bd3ddf.png" src="_images/6d20074d2b2a27acc78df54e6e5fe03601a09067fdb03fecdec148cb56bd3ddf.png" />
<img alt="_images/82d1513c82c46e51be570d749b7ba16475350205d41099d59cf9e26c8e29aa6c.png" src="_images/82d1513c82c46e51be570d749b7ba16475350205d41099d59cf9e26c8e29aa6c.png" />
<img alt="_images/e7dad85d9f4aa739a70286c7fd67ec6582e027ab2148fe09d8bb95be75d787ba.png" src="_images/e7dad85d9f4aa739a70286c7fd67ec6582e027ab2148fe09d8bb95be75d787ba.png" />
<img alt="_images/76051b73b6aa4ee6a77778fafbee8cbce8059d443e1e2f89b779d6c43ff66594.png" src="_images/76051b73b6aa4ee6a77778fafbee8cbce8059d443e1e2f89b779d6c43ff66594.png" />
<img alt="_images/0744885cc279d8d7a63c83c070360c32e1e564f81ee718cafd7ef8926d6090af.png" src="_images/0744885cc279d8d7a63c83c070360c32e1e564f81ee718cafd7ef8926d6090af.png" />
<img alt="_images/5608d196bf839fceb793c38e09d790b419be5a8c86386bcfde5bf2a996bf5080.png" src="_images/5608d196bf839fceb793c38e09d790b419be5a8c86386bcfde5bf2a996bf5080.png" />
<img alt="_images/c1dcc0290d63c350ad4830271f21940dcbd182218874e341149eba0d0aff5a3a.png" src="_images/c1dcc0290d63c350ad4830271f21940dcbd182218874e341149eba0d0aff5a3a.png" />
<img alt="_images/d77c8f3b5850d009787718d7c98390eb48d05c5e36452a619b3b690de5c9ee56.png" src="_images/d77c8f3b5850d009787718d7c98390eb48d05c5e36452a619b3b690de5c9ee56.png" />
<img alt="_images/ea7e21c4ca3cdc7dec0b3f75e106163ac6af6242e8ae82e51d1b90aeb378d7df.png" src="_images/ea7e21c4ca3cdc7dec0b3f75e106163ac6af6242e8ae82e51d1b90aeb378d7df.png" />
<img alt="_images/47e41253983cf1697895b54735fc9d66e609c0367b6b586582183c14fb80bef4.png" src="_images/47e41253983cf1697895b54735fc9d66e609c0367b6b586582183c14fb80bef4.png" />
<img alt="_images/c6c6a359ea97f79de4326b970beb7b0f0c3e4a32636c94ade492c24da53a1580.png" src="_images/c6c6a359ea97f79de4326b970beb7b0f0c3e4a32636c94ade492c24da53a1580.png" />
<img alt="_images/1dede347fb6f9944f264ab9e0ee2341dd029935fe4e34b36780ec654ddd03df8.png" src="_images/1dede347fb6f9944f264ab9e0ee2341dd029935fe4e34b36780ec654ddd03df8.png" />
</div>
</div>
<section id="interpretacion-de-la-tabla-chi-cuadrado">
<h3>Interpretación de la tabla Chi-cuadrado<a class="headerlink" href="#interpretacion-de-la-tabla-chi-cuadrado" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>La prueba Chi-cuadrado evalúa si <strong>existe relación</strong> entre cada variable categórica y el target <strong>Churn</strong>.</p></li>
<li><p>Un <strong>p-value &lt; 0.05</strong> indica que la variable tiene una relación significativa con el churn.</p></li>
<li><p>En los resultados observados:</p>
<ul>
<li><p><strong>Contract</strong> presenta el chi² más alto → es una de las variables más influyentes.</p></li>
<li><p><strong>OnlineSecurity</strong>, <strong>TechSupport</strong>, <strong>InternetService</strong>, <strong>PaymentMethod</strong>, <strong>OnlineBackup</strong>, <strong>DeviceProtection</strong>, <strong>StreamingMovies</strong>, <strong>StreamingTV</strong>, <strong>PaperlessBilling</strong> también muestran <strong>p-values extremadamente pequeños</strong>, indicando fuerte asociación con churn.</p></li>
<li><p>Esto implica que <strong>la distribución de churn cambia claramente entre las categorías</strong> de estas variables.</p></li>
</ul>
</li>
</ul>
</section>
<section id="interpretacion-de-las-barras-apiladas-proporciones-por-categoria">
<h3>Interpretación de las barras apiladas (proporciones por categoría)<a class="headerlink" href="#interpretacion-de-las-barras-apiladas-proporciones-por-categoria" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Cada gráfico muestra la <strong>proporción de churn (1)</strong> y <strong>no-churn (0)</strong> dentro de cada categoría.</p></li>
<li><p>Patrones importantes:</p>
<ul>
<li><p><strong>Contract</strong></p>
<ul>
<li><p><em>Month-to-month</em> tiene una proporción de churn notablemente más alta.</p></li>
<li><p><em>One year</em> y <em>Two year</em> casi no presentan churn → contratos largos retienen clientes.</p></li>
</ul>
</li>
<li><p><strong>InternetService</strong></p>
<ul>
<li><p><em>Fiber optic</em> tiene más churn.</p></li>
<li><p><em>No internet service</em> casi no presenta churn.</p></li>
</ul>
</li>
<li><p><strong>OnlineSecurity, TechSupport, OnlineBackup, DeviceProtection</strong></p>
<ul>
<li><p>Cuando el cliente no tiene estos servicios, la proporción de churn es mayor.</p></li>
<li><p>La ausencia de servicios adicionales parece relacionarse con mayor abandono.</p></li>
</ul>
</li>
<li><p><strong>PaymentMethod</strong></p>
<ul>
<li><p><em>Electronic check</em> muestra un churn mucho más alto que los métodos automáticos.</p></li>
</ul>
</li>
<li><p><strong>PaperlessBilling</strong></p>
<ul>
<li><p>Los usuarios con facturación sin papel tienden a abandonar más.</p></li>
</ul>
</li>
<li><p><strong>Variables como gender</strong></p>
<ul>
<li><p>No muestran cambios claros entre categorías → baja relevancia.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
<section id="id3">
<h3>Conclusión general<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>La mayoría de las variables categóricas del servicio sí presentan patrones claros asociados al churn.</p></li>
<li><p>Variables relacionadas con <strong>contrato</strong>, <strong>seguridad</strong>, <strong>servicios adicionales</strong>, <strong>método de pago</strong> y <strong>tipo de internet</strong> son especialmente importantes.</p></li>
<li><p>Este análisis confirma que estas columnas deben ser consideradas como <strong>predictoras clave</strong> para el modelo de clasificación.</p></li>
</ul>
</section>
</section>
<section id="matriz-de-correlacion-y-variables-numericas-mas-relacionadas-con-el-churn">
<h2><strong>11. Matriz de Correlación y Variables Numéricas Más Relacionadas con el Churn</strong><a class="headerlink" href="#matriz-de-correlacion-y-variables-numericas-mas-relacionadas-con-el-churn" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corr</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">num_cols</span> <span class="o">+</span> <span class="p">[</span><span class="n">TARGET</span><span class="p">]]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">0.6</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">corr</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="mf">0.6</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">corr</span><span class="o">.</span><span class="n">columns</span><span class="p">)))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;vlag&quot;</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Matriz de correlación (numéricas + target)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">FIGS</span><span class="o">/</span><span class="s2">&quot;eda_corr_heatmap.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">160</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Top correlaciones absolutas con el target</span>
<span class="n">corr_target</span> <span class="o">=</span> <span class="n">corr</span><span class="p">[</span><span class="n">TARGET</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">TARGET</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">corr_target</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ca3e8b1944f8b6f64d4d35868c583919580ab8dbbc607f96f596469e0e38d387.png" src="_images/ca3e8b1944f8b6f64d4d35868c583919580ab8dbbc607f96f596469e0e38d387.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tenure            0.352229
TotalCharges      0.199484
MonthlyCharges    0.193356
SeniorCitizen     0.150889
Name: Churn, dtype: float64
</pre></div>
</div>
</div>
</div>
<section id="interpretacion-de-la-matriz-de-correlacion">
<h3>Interpretación de la Matriz de Correlación<a class="headerlink" href="#interpretacion-de-la-matriz-de-correlacion" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>La matriz muestra cómo se relaciona cada variable numérica con las demás, incluyendo el target.</p></li>
<li><p>Los colores más intensos indican correlaciones fuertes (positivas o negativas).</p></li>
<li><p>Las correlaciones con el target <code class="docutils literal notranslate"><span class="pre">Churn</span></code> son moderadas pero informativas.</p></li>
</ul>
</section>
<section id="resultados-principales">
<h3>Resultados principales:<a class="headerlink" href="#resultados-principales" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>tenure (0.35)</strong>:</p>
<ul>
<li><p>La correlación negativa sugiere que a menor tiempo de permanencia, mayor probabilidad de churn.</p></li>
<li><p>Es la variable numérica más relevante.</p></li>
</ul>
</li>
<li><p><strong>TotalCharges (0.20)</strong> y <strong>MonthlyCharges (0.19)</strong>:</p>
<ul>
<li><p>Ambos muestran correlaciones bajas pero significativas.</p></li>
<li><p>Clientes con cargos altos tienden a abandonar más.</p></li>
</ul>
</li>
<li><p><strong>SeniorCitizen (0.15)</strong>:</p>
<ul>
<li><p>Correlación baja pero notable.</p></li>
<li><p>Personas mayores presentan una ligera tendencia a abandonar más.</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="id4">
<h2>Conclusión<a class="headerlink" href="#id4" title="Link to this heading">#</a></h2>
<p>Aunque las variables numéricas no tienen correlaciones extremadamente altas con el churn, sí aportan información relevante.<br />
Especialmente <strong>tenure</strong>, que destaca claramente como el predictor numérico más importante.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ======= FIX ROBUSTO =======</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">chi2_contingency</span>

<span class="k">def</span><span class="w"> </span><span class="nf">cramers_v</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">confusion</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">confusion</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">chi2</span> <span class="o">=</span> <span class="n">chi2_contingency</span><span class="p">(</span><span class="n">confusion</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">confusion</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">phi2</span> <span class="o">=</span> <span class="n">chi2</span> <span class="o">/</span> <span class="n">n</span>
    <span class="n">r</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">confusion</span><span class="o">.</span><span class="n">shape</span>
    <span class="c1"># corrección de bias</span>
    <span class="n">phi2corr</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">phi2</span> <span class="o">-</span> <span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">rcorr</span> <span class="o">=</span> <span class="n">r</span> <span class="o">-</span> <span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">r</span>
    <span class="n">kcorr</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">k</span>
    <span class="n">denom</span> <span class="o">=</span> <span class="nb">min</span><span class="p">((</span><span class="n">kcorr</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">rcorr</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">phi2corr</span> <span class="o">/</span> <span class="n">denom</span><span class="p">)</span> <span class="k">if</span> <span class="n">denom</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span>

<span class="k">def</span><span class="w"> </span><span class="nf">entropy</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">vc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="n">vc</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">vc</span> <span class="o">+</span> <span class="mf">1e-12</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">conditional_entropy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">ey</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
        <span class="n">ey</span> <span class="o">+=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">*</span> <span class="n">entropy</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ey</span>

<span class="k">def</span><span class="w"> </span><span class="nf">theils_u</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">hx</span> <span class="o">=</span> <span class="n">entropy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="mf">1.0</span> <span class="k">if</span> <span class="n">hx</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="p">(</span><span class="n">hx</span> <span class="o">-</span> <span class="n">conditional_entropy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span> <span class="o">/</span> <span class="n">hx</span>

<span class="k">def</span><span class="w"> </span><span class="nf">correlation_ratio</span><span class="p">(</span><span class="n">categories</span><span class="p">,</span> <span class="n">measurements</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    η (categorical -&gt; numerical), en [0,1]</span>
<span class="sd">    Robusta a NaN y a columnas numéricas con dtype object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cats</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">categories</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>
    <span class="n">meas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">measurements</span><span class="p">),</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>  <span class="c1"># fuerza float</span>
    <span class="c1"># grupos como arrays sin NaN</span>
    <span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">meas</span><span class="p">[</span><span class="n">cats</span> <span class="o">==</span> <span class="n">lev</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">lev</span> <span class="ow">in</span> <span class="n">cats</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="p">]</span>
    <span class="n">sizes</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">size</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">]</span>
    <span class="n">n_tot</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sizes</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">n_tot</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="c1"># media global (escalar)</span>
    <span class="n">total_sum</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">g</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">groups</span> <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]))</span>
    <span class="n">grand_mean</span> <span class="o">=</span> <span class="n">total_sum</span> <span class="o">/</span> <span class="n">n_tot</span>

    <span class="c1"># Suma de cuadrados entre grupos (escalar)</span>
    <span class="n">ss_between</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">g</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">-</span> <span class="n">grand_mean</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
                               <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">groups</span> <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]))</span>
    <span class="c1"># Suma de cuadrados total (escalar)</span>
    <span class="n">ss_total</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">g</span> <span class="o">-</span> <span class="n">grand_mean</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">groups</span> <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]))</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ss_between</span> <span class="o">/</span> <span class="p">(</span><span class="n">ss_total</span> <span class="o">+</span> <span class="mf">1e-12</span><span class="p">))</span> <span class="k">if</span> <span class="n">ss_total</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span>

<span class="k">def</span><span class="w"> </span><span class="nf">mixed_corr_matrix</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">num_cols</span><span class="p">,</span> <span class="n">cat_cols</span><span class="p">,</span> <span class="n">method_cat</span><span class="o">=</span><span class="s2">&quot;cramers_v&quot;</span><span class="p">,</span> <span class="n">top_cats</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">top_cats</span><span class="p">:</span>
        <span class="n">cat_cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cat_cols</span><span class="p">)[:</span><span class="n">top_cats</span><span class="p">]</span>

    <span class="c1"># asegura que num_cols sean realmente numéricas (convierte bool a int)</span>
    <span class="n">_num_cols</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">num_cols</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_bool_dtype</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">c</span><span class="p">]):</span>
            <span class="n">_num_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">c</span><span class="p">]):</span>
            <span class="c1"># intenta convertir silenciosamente</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">df</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="n">_num_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_num_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="n">num_cols</span> <span class="o">=</span> <span class="n">_num_cols</span>

    <span class="n">cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">num_cols</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">cat_cols</span><span class="p">)</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">))),</span> <span class="n">index</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cols</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">c2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cols</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span>
                <span class="n">M</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">c1</span> <span class="ow">in</span> <span class="n">num_cols</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">c2</span> <span class="ow">in</span> <span class="n">num_cols</span><span class="p">):</span>
                <span class="n">M</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">]]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">c1</span> <span class="ow">in</span> <span class="n">cat_cols</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">c2</span> <span class="ow">in</span> <span class="n">cat_cols</span><span class="p">):</span>
                <span class="n">M</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">]</span> <span class="o">=</span> <span class="n">cramers_v</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">c1</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">c2</span><span class="p">])</span> <span class="k">if</span> <span class="n">method_cat</span> <span class="o">==</span> <span class="s2">&quot;cramers_v&quot;</span> <span class="k">else</span> <span class="n">theils_u</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">c1</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">c2</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># mixto: cat&lt;-&gt;num (η)</span>
                <span class="n">cat</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">)</span> <span class="k">if</span> <span class="n">c1</span> <span class="ow">in</span> <span class="n">cat_cols</span> <span class="k">else</span> <span class="p">(</span><span class="n">c2</span><span class="p">,</span> <span class="n">c1</span><span class="p">)</span>
                <span class="n">M</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">]</span> <span class="o">=</span> <span class="n">correlation_ratio</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">cat</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">num</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">M</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="matriz-de-correlacion-mixta-pearson-cramers-v">
<h2><strong>12. Matriz de Correlación Mixta (Pearson + Cramér’s V + η)</strong><a class="headerlink" href="#matriz-de-correlacion-mixta-pearson-cramers-v" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="n">mixed_corr_matrix</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">num_cols</span><span class="o">=</span><span class="n">num_cols</span><span class="p">,</span> <span class="n">cat_cols</span><span class="o">=</span><span class="n">cat_cols</span><span class="p">,</span>
                      <span class="n">method_cat</span><span class="o">=</span><span class="s2">&quot;cramers_v&quot;</span><span class="p">,</span> <span class="n">top_cats</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">0.6</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.6</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;vlag&quot;</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Matriz de correlación mixta (Pearson / Cramér’s V / η)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">FIGS</span><span class="o">/</span><span class="s2">&quot;eda_mixed_correlation.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">160</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c95f36e366a861664732f0cf1b8ce43e8acd4df57d3d56c283870966e5620005.png" src="_images/c95f36e366a861664732f0cf1b8ce43e8acd4df57d3d56c283870966e5620005.png" />
</div>
</div>
<section id="interpretacion-de-la-matriz-mixta">
<h3>Interpretación de la matriz mixta<a class="headerlink" href="#interpretacion-de-la-matriz-mixta" title="Link to this heading">#</a></h3>
</section>
<section id="relaciones-fuertes-entre-variables-categoricas">
<h3>1. Relaciones fuertes entre variables categóricas<a class="headerlink" href="#relaciones-fuertes-entre-variables-categoricas" title="Link to this heading">#</a></h3>
<p>Se observan bloques intensos entre:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">InternetService</span></code>, <code class="docutils literal notranslate"><span class="pre">OnlineSecurity</span></code>, <code class="docutils literal notranslate"><span class="pre">TechSupport</span></code>, <code class="docutils literal notranslate"><span class="pre">OnlineBackup</span></code>,<br />
<code class="docutils literal notranslate"><span class="pre">DeviceProtection</span></code>, <code class="docutils literal notranslate"><span class="pre">StreamingTV</span></code>, <code class="docutils literal notranslate"><span class="pre">StreamingMovies</span></code>, <code class="docutils literal notranslate"><span class="pre">Contract</span></code>.</p></li>
</ul>
<p>Estas variables muestran <strong>dependencia entre sí</strong>, debido a que muchas pertenecen a servicios complementarios (internet + seguridad + soporte + entretenimiento).</p>
</section>
<section id="variables-numericas-asociadas-con-servicios">
<h3>2. Variables numéricas asociadas con servicios<a class="headerlink" href="#variables-numericas-asociadas-con-servicios" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">MonthlyCharges</span></code> y <code class="docutils literal notranslate"><span class="pre">TotalCharges</span></code> correlacionan de forma clara con casi todos los servicios.<br />
→ Tiene sentido: más servicios contratados = mayor factura.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tenure</span></code> también muestra relaciones inversas con algunas categorías, lo que sugiere que:
→ clientes con contratos más largos tienden a tener más servicios y menor churn.</p></li>
</ul>
</section>
<section id="bloque-con-el-target-churn">
<h3>3. Bloque con el target (Churn)<a class="headerlink" href="#bloque-con-el-target-churn" title="Link to this heading">#</a></h3>
<p>Aunque el gráfico no muestra explícitamente la columna <code class="docutils literal notranslate"><span class="pre">Churn</span></code> (dependiendo de la función), el comportamiento general indica:</p>
<ul class="simple">
<li><p>El churn está <strong>más relacionado</strong> con:</p>
<ul>
<li><p>tipo de contrato (<strong>Contract</strong>)</p></li>
<li><p>tipo de servicio de internet (<strong>InternetService</strong>)</p></li>
<li><p>servicios adicionales (<strong>OnlineSecurity, OnlineBackup, TechSupport, DeviceProtection</strong>)</p></li>
<li><p>método de pago (<strong>PaymentMethod</strong>)</p></li>
<li><p>facturación electrónica (<strong>PaperlessBilling</strong>)</p></li>
</ul>
</li>
</ul>
<p>Estas coincidencias corroboran lo visto anteriormente en:</p>
<ul class="simple">
<li><p>Chi-cuadrado</p></li>
<li><p>Barras apiladas</p></li>
<li><p>Violin plots</p></li>
</ul>
</section>
<section id="relaciones-debiles">
<h3>4. Relaciones débiles<a class="headerlink" href="#relaciones-debiles" title="Link to this heading">#</a></h3>
<p>Variables como:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gender</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PhoneService</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Dependents</span></code>
muestran muy poca asociación con el resto de columnas.</p></li>
</ul>
</section>
<section id="id5">
<h3>Conclusión General<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<p>La matriz mixta permite ver que:</p>
<ul class="simple">
<li><p>Los servicios contratados forman un <strong>clúster altamente correlacionado</strong>.</p></li>
<li><p>El churn está influenciado principalmente por el <strong>tipo de servicio</strong>, <strong>método de pago</strong>, <strong>seguridad</strong> y <strong>duración del contrato</strong>.</p></li>
<li><p>Variables como <code class="docutils literal notranslate"><span class="pre">tenure</span></code>, <code class="docutils literal notranslate"><span class="pre">MonthlyCharges</span></code> y <code class="docutils literal notranslate"><span class="pre">TotalCharges</span></code> refuerzan estos patrones.</p></li>
</ul>
</section>
</section>
<section id="pairplot-de-las-principales-variables-numericas-vs-churn">
<h2><strong>13: Pairplot de las principales variables numéricas vs <code class="docutils literal notranslate"><span class="pre">Churn</span></code></strong><a class="headerlink" href="#pairplot-de-las-principales-variables-numericas-vs-churn" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ========= Pairplot con top-k numéricas =========</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="n">TARGET</span> <span class="o">=</span> <span class="s2">&quot;Churn&quot;</span>
<span class="c1"># Selecciona top 8 numéricas por |corr| con el target (si es binario, Pearson≈point-biserial)</span>
<span class="n">top_k</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">corr_target</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">num_cols</span> <span class="o">+</span> <span class="p">[</span><span class="n">TARGET</span><span class="p">]]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="n">TARGET</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">TARGET</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="n">top_num</span> <span class="o">=</span> <span class="n">corr_target</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">top_k</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">corr_target</span><span class="p">)))</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">top_num</span> <span class="o">+</span> <span class="p">[</span><span class="n">TARGET</span><span class="p">]]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))),</span> <span class="n">hue</span><span class="o">=</span><span class="n">TARGET</span><span class="p">,</span> <span class="n">diag_kind</span><span class="o">=</span><span class="s2">&quot;hist&quot;</span><span class="p">,</span> <span class="n">corner</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Pairplot — top variables numéricas vs Churn&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">FIGS</span><span class="o">/</span><span class="s2">&quot;eda_pairplot_topnum.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">140</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e3fdea6bf841a765aa87fd575516cbd6d777809414eb7bfac7864d144f30a232.png" src="_images/e3fdea6bf841a765aa87fd575516cbd6d777809414eb7bfac7864d144f30a232.png" />
</div>
</div>
<section id="pairplot">
<h3><strong>Pairplot</strong><a class="headerlink" href="#pairplot" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Diagonal (histogramas de cada variable)</strong></p>
<ul class="simple">
<li><p>Describe la <strong>distribución marginal</strong> de cada variable:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">tenure</span></code>: muchos clientes con pocos meses de permanencia.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MonthlyCharges</span></code>: concentración en valores intermedios-altos.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TotalCharges</span></code>: sesgo fuerte hacia valores bajos, cola larga.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SeniorCitizen</span></code>: variable binaria (picos en 0 y 1).</p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">tenure</span></code> vs <code class="docutils literal notranslate"><span class="pre">TotalCharges</span></code></strong></p>
<ul class="simple">
<li><p>Nube casi lineal ascendente: a mayor <code class="docutils literal notranslate"><span class="pre">tenure</span></code>, mayor <code class="docutils literal notranslate"><span class="pre">TotalCharges</span></code>.</p></li>
<li><p>Los puntos naranjas (churn=1) se acumulan en la parte de <strong>tenure bajo</strong> y <strong>TotalCharges bajos/medios</strong>.</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">tenure</span></code> vs <code class="docutils literal notranslate"><span class="pre">MonthlyCharges</span></code></strong></p>
<ul class="simple">
<li><p>No hay una relación lineal muy clara, pero:</p>
<ul>
<li><p>Clientes de <strong>poco tenure</strong> con <strong>MonthlyCharges relativamente altos</strong> muestran más puntos de churn (naranja).</p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">MonthlyCharges</span></code> vs <code class="docutils literal notranslate"><span class="pre">TotalCharges</span></code></strong></p>
<ul class="simple">
<li><p>Para un mismo cargo mensual, el <code class="docutils literal notranslate"><span class="pre">TotalCharges</span></code> aumenta con el tiempo (tenure).</p></li>
<li><p>Los casos de churn tienden a tener <code class="docutils literal notranslate"><span class="pre">TotalCharges</span></code> menores (clientes que se fueron relativamente pronto).</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">SeniorCitizen</span></code> vs las demás</strong></p>
<ul class="simple">
<li><p>Se ven dos bandas horizontales (0 y 1).</p></li>
<li><p>La banda <code class="docutils literal notranslate"><span class="pre">SeniorCitizen</span> <span class="pre">=</span> <span class="pre">1</span></code> tiene proporcionalmente más puntos naranjas → adultos mayores algo más propensos a abandonar.</p></li>
</ul>
</li>
</ol>
</section>
<section id="id6">
<h3>Conclusión<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>El pairplot confirma visualmente que las variables:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">tenure</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TotalCharges</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MonthlyCharges</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SeniorCitizen</span></code>
están <strong>relacionadas con el churn</strong>, aunque de forma no necesariamente lineal.</p></li>
</ul>
</li>
<li><p>Patrones clave:</p>
<ul>
<li><p>Clientes con <strong>poco tiempo en la empresa</strong> y <strong>cargos totales bajos/medios</strong> son los que más churn presentan.</p></li>
<li><p>Cargos mensuales altos parecen asociarse con mayor probabilidad de abandono.</p></li>
<li><p>Los adultos mayores contribuyen ligeramente más al churn.</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="pca-2d-sobre-variables-numericas-y-relacion-con-churn">
<h2><strong>14. PCA 2D sobre variables numéricas y relación con <code class="docutils literal notranslate"><span class="pre">Churn</span></code></strong><a class="headerlink" href="#pca-2d-sobre-variables-numericas-y-relacion-con-churn" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ========= PCA 2D sobre numéricas =========</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.decomposition</span><span class="w"> </span><span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="n">X_num</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">num_cols</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">X_num</span> <span class="o">=</span> <span class="n">X_num</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">X_num</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">Xz</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_num</span><span class="p">)</span>

<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">Xz</span><span class="p">)</span>

<span class="n">pca_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PC1&quot;</span><span class="p">,</span><span class="s2">&quot;PC2&quot;</span><span class="p">])</span>
<span class="n">pca_df</span><span class="p">[</span><span class="n">TARGET</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">TARGET</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">pca_df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">3000</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">pca_df</span><span class="p">))),</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;PC1&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;PC2&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="n">TARGET</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PCA 2D (var. explicada: </span><span class="si">{</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">FIGS</span><span class="o">/</span><span class="s2">&quot;eda_pca2d_num.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/80c25b0617da286fd6289f05ed201b9fd840703af932a84fedf93e3f100fe821.png" src="_images/80c25b0617da286fd6289f05ed201b9fd840703af932a84fedf93e3f100fe821.png" />
</div>
</div>
<section id="grafico-de-pca">
<h3><strong>Gráfico de PCA</strong><a class="headerlink" href="#grafico-de-pca" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Cada punto es un cliente proyectado en el plano (<code class="docutils literal notranslate"><span class="pre">PC1</span></code>, <code class="docutils literal notranslate"><span class="pre">PC2</span></code>).</p></li>
<li><p>Puntos cercanos tienen <strong>perfiles numéricos similares</strong> (en <code class="docutils literal notranslate"><span class="pre">tenure</span></code>, <code class="docutils literal notranslate"><span class="pre">MonthlyCharges</span></code>, <code class="docutils literal notranslate"><span class="pre">TotalCharges</span></code>, <code class="docutils literal notranslate"><span class="pre">SeniorCitizen</span></code>, etc.).</p></li>
<li><p>El gráfico muestra dos “bandas” o regiones principales:</p>
<ul>
<li><p>Una zona inferior (PC2 más baja).</p></li>
<li><p>Otra zona superior (PC2 más alta).</p></li>
</ul>
</li>
<li><p>Los colores (0 / 1) están <strong>mezclados</strong>, pero:</p>
<ul>
<li><p>Se ve una ligera concentración de puntos naranjas (churn=1) en ciertas zonas del plano, lo que indica que la combinación lineal de las variables numéricas captura algo de la señal de churn.</p></li>
</ul>
</li>
</ul>
</section>
<section id="conclusiones-del-pca">
<h3>Conclusiones del PCA<a class="headerlink" href="#conclusiones-del-pca" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Las dos primeras componentes principales explican <strong>≈ 81.6% de la variabilidad</strong> de todas las variables numéricas → la estructura numérica del dataset queda bastante bien resumida en 2D.</p></li>
<li><p>Sin embargo, las clases <code class="docutils literal notranslate"><span class="pre">Churn</span> <span class="pre">=</span> <span class="pre">0</span></code> y <code class="docutils literal notranslate"><span class="pre">Churn</span> <span class="pre">=</span> <span class="pre">1</span></code> <strong>no quedan totalmente separadas</strong>:</p>
<ul>
<li><p>Hay solapamiento considerable entre ambas.</p></li>
<li><p>Esto sugiere que:</p>
<ul>
<li><p>Las variables numéricas por sí solas <strong>no son suficientes</strong> para separar perfectamente el churn.</p></li>
<li><p>Será importante incorporar también <strong>variables categóricas</strong> y modelos más flexibles (no solo lineales) para capturar mejor la frontera entre clases.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>El PCA es útil como herramienta de <strong>visualización y diagnóstico</strong>:</p>
<ul>
<li><p>Permite detectar posibles grupos o patrones globales.</p></li>
<li><p>Ayuda a verificar si hay outliers extremos o estructuras raras en los datos numéricos.</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="deteccion-de-outliers-con-iqr-y-z-score">
<h2><strong>15.Detección de Outliers con IQR y Z-Score</strong><a class="headerlink" href="#deteccion-de-outliers-con-iqr-y-z-score" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># IQR</span>
<span class="n">out_iqr</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">num_cols</span><span class="p">:</span>
    <span class="n">q1</span><span class="p">,</span> <span class="n">q3</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">df</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>
    <span class="n">iqr</span> <span class="o">=</span> <span class="n">q3</span> <span class="o">-</span> <span class="n">q1</span>
    <span class="n">li</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="n">q1</span> <span class="o">-</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">iqr</span><span class="p">,</span> <span class="n">q3</span> <span class="o">+</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">iqr</span>
    <span class="n">out_iqr</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">li</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">ls</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">out_iqr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">out_iqr</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;outliers_IQR&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">out_iqr</span><span class="p">)</span>

<span class="c1"># Z-score (&gt;3)</span>
<span class="n">out_z</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">num_cols</span><span class="p">:</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">zscore</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span> <span class="n">nan_policy</span><span class="o">=</span><span class="s2">&quot;omit&quot;</span><span class="p">))</span>
    <span class="n">out_z</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">out_z</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">out_z</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;outliers_Z3&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">out_z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SeniorCitizen     1142
tenure               0
MonthlyCharges       0
TotalCharges         0
Name: outliers_IQR, dtype: int64
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SeniorCitizen     0
tenure            0
MonthlyCharges    0
TotalCharges      0
Name: outliers_Z3, dtype: int64
</pre></div>
</div>
</div>
</div>
<p><strong>La única variable con outliers según IQR es <code class="docutils literal notranslate"><span class="pre">SeniorCitizen</span></code></strong>, porque:</p>
<ul class="simple">
<li><p>No es una variable continua.</p></li>
<li><p>Solo toma valores 0 y 1.</p></li>
<li><p>La fórmula del IQR considera ambos como outliers por distribución discreta.</p></li>
</ul>
<p><strong>Conclusión:</strong><br />
Los outliers aquí <strong>no son reales</strong>, sino un efecto esperado en variables binarias.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="01_contexto_churn.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">1. Contexto del Dataset: <em>Telco Customer Churn</em></p>
      </div>
    </a>
    <a class="right-next"
       href="03_preprocesamiento.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><strong>3. Preprocesamiento de Datos</strong></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#librerias">Librerías</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#carga-de-la-base-de-datos"><strong>1. Carga de la Base de Datos</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#descarga-y-carga-del-dataset-telco-customer-churn">Descarga y carga del dataset <em>Telco Customer Churn</em></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#carga-del-dataframe">Carga del DataFrame</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#vista-previa-de-los-datos">Vista previa de los datos</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lectura-del-dataset-y-verificacion"><strong>2. Lectura del Dataset y verificación</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#salida-observada">Salida observada</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#limpieza-de-nombres-de-columnas"><strong>3. Limpieza de nombres de columnas</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-la-salida-df-info">Interpretación de la salida (<code class="docutils literal notranslate"><span class="pre">df.info()</span></code>)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conversion-de-tipos-target-binario-y-particion-de-variables-numericas-vs-categoricas"><strong>4. Conversión de tipos, target binario y partición de variables (numéricas vs. categóricas)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#que-hace-el-codigo">Qué hace el código</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-la-salida">Interpretación de la salida</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#importancia">Importancia</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conteo-de-valores-faltantes-por-columna"><strong>5. Conteo de valores faltantes por columna</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#distribucion-del-target-churn-porcentaje-y-conteo-implicaciones-de-desbalance"><strong>6. Distribución del target <code class="docutils literal notranslate"><span class="pre">Churn</span></code> (porcentaje y conteo) + implicaciones de desbalance</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Interpretación de la salida</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resumen-estadistico-numericas-cardinalidad-y-top-frecuencias-categoricas"><strong>7. Resumen estadístico (numéricas) + cardinalidad y top-frecuencias (categóricas)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Interpretación de la salida</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#numericas-describe-t">1) Numéricas (<code class="docutils literal notranslate"><span class="pre">describe().T</span></code>)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#categoricas-cardinalidad-y-top-k">2) Categóricas (cardinalidad y top-k)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-univariada-distribuciones-numericas-y-categoricas"><strong>8. Visualización univariada: Distribuciones numéricas y categóricas</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-los-resultados">Interpretación de los resultados</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-numericas">Variables numéricas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-categoricas-barras">Variables categóricas (barras)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusión</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#relacion-de-variables-numericas-con-churn-violines-prueba-de-mannwhitney"><strong>9. Relación de variables numéricas con <code class="docutils literal notranslate"><span class="pre">Churn</span></code>: violines + prueba de Mann–Whitney</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-los-violines">Interpretación de los violines</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resultados-de-mannwhitney">Resultados de Mann–Whitney</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-general">Conclusión general</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prueba-chi-cuadrado-y-barras-apiladas-por-categoria"><strong>10. Prueba Chi-cuadrado y Barras Apiladas por Categoría</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-la-tabla-chi-cuadrado">Interpretación de la tabla Chi-cuadrado</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-las-barras-apiladas-proporciones-por-categoria">Interpretación de las barras apiladas (proporciones por categoría)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Conclusión general</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matriz-de-correlacion-y-variables-numericas-mas-relacionadas-con-el-churn"><strong>11. Matriz de Correlación y Variables Numéricas Más Relacionadas con el Churn</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-la-matriz-de-correlacion">Interpretación de la Matriz de Correlación</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resultados-principales">Resultados principales:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Conclusión</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matriz-de-correlacion-mixta-pearson-cramers-v"><strong>12. Matriz de Correlación Mixta (Pearson + Cramér’s V + η)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-la-matriz-mixta">Interpretación de la matriz mixta</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relaciones-fuertes-entre-variables-categoricas">1. Relaciones fuertes entre variables categóricas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-numericas-asociadas-con-servicios">2. Variables numéricas asociadas con servicios</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bloque-con-el-target-churn">3. Bloque con el target (Churn)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relaciones-debiles">4. Relaciones débiles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Conclusión General</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pairplot-de-las-principales-variables-numericas-vs-churn"><strong>13: Pairplot de las principales variables numéricas vs <code class="docutils literal notranslate"><span class="pre">Churn</span></code></strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pairplot"><strong>Pairplot</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Conclusión</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pca-2d-sobre-variables-numericas-y-relacion-con-churn"><strong>14. PCA 2D sobre variables numéricas y relación con <code class="docutils literal notranslate"><span class="pre">Churn</span></code></strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grafico-de-pca"><strong>Gráfico de PCA</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusiones-del-pca">Conclusiones del PCA</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deteccion-de-outliers-con-iqr-y-z-score"><strong>15.Detección de Outliers con IQR y Z-Score</strong></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Juan Andres Ramos, Mariana Franco y Jeronimo Dominguez
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p> Proyecto educativo – Miniproyecto 6</p>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>